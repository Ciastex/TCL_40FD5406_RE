var EntryPoint=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=28)}([function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("stream")},function(e,t){e.exports=require("path")},function(e,t,n){var r={};r._propDict={};var i=(n(0),n(11).platformServices),o=n(63),s=n(57),a=s.SocketClient;r.getReadWriteDir=function(){return"//data/astronav//apps/globoplay/"},r.getReadOnlyDir=function(){return"//system/apps/globoplay_activity/client/apps//globoplay/"},r.getFallbackDir=function(){return process.cwd()},r.init=function(){var e=r;if(!e._isInit){e._fontSupport={ttf:!0,otf:!0};var t=process.env.UV_THREADPOOL_SIZE;e._propDict["traits.loadqueue.max_connections"]=t>4?t-4:4,console.log("[PlatformServices.init] setting traits.network.prefer_http"),e._propDict["traits.network.prefer_http"]=!0;var o=i.initProperties();for(var s in o)e._propDict[s]=o[s];console.log("[PlatformServices] init - loading pl_properties.json");var a=n(59);for(var s in a)console.log("[PlatformServices] init - overwriting key "+s+" with value "+a[s]),e._propDict[s]=a[s];var u=e._propDict["traits.player.video_blacklist"];if(u){for(var l={},f=0;f<u.length;f++)l[""+u[f]]=!0;e._propDict["traits.player.video_blacklist"]=l}var h=this._propDict["system.os"],p=this._propDict["system.manufacturer"],d=this._propDict["system.model"];e._propDict.userAgent="GloboplayNative/0.8.6 ("+h+"; "+p+"; "+d+"); "+p+" "+d,e._isInit=!0,e.currentRuntimeState="low_profile",c.getEventEmitter().on("runtimestatechange",function(t){e.currentRuntimeState=t})}},r.setProperty=function(e,t){r._propDict[e]=t},r.getProperty=function(e){return r.init(),r._propDict[e]},r.hasFontSupport=function(e){return r.init(),r._fontSupport[e]},r.hintGC=function(){global&&"function"==typeof global.gc&&(console.log("[PlatformServices.hintGC] calling global.gc()"),global.gc())},r.hasVideoSupport=function(e){return!("novatek"==r.getProperty("platform")&&"S4900"==r.getProperty("system.model")&&"DRM"==e&&!r.getProperty("system.pl.revision"))&&!!r.getProperty("system.video_support."+e)},r.getGUID=function(){return r.getProperty("system.mac_address")},r.exit=function(){DEF_FULL_STATE_MACHINE&&!r._propDict["system.has_supervisor"]?i.setRuntimeState("low_profile"):(console.log("[PlatformServices.exit] Not FULL_STATE_MACHINE or system.has_supervisor"),i.exit())},r.setRuntimeState=function(e,t){return r._pendingTimeout&&(clearTimeout(r._pendingTimeout),delete r._pendingTimeout),"function"==typeof t&&c.getEventEmitter().once("runtimestatechange",t),"overlay"==e&&r.getProperty("traits.gfx.cleanup_on_paused_to_overlay")&&"paused"==i.getRuntimeState()?(r._pendingTimeout=setTimeout(function(){delete r._pendingTimeout,this.currentRuntimeState="overlay",i.setRuntimeState("overlay")},1e3),this.currentRuntimeState="low_profile",i.setRuntimeState("low_profile")):(console.log("[PlatformServices] setRuntimeState - calling setRuntimeState "+e),this.currentRuntimeState=e,i.setRuntimeState(e))},r.getRuntimeState=function(){if(this.getProperty("traits.runtimestate.use_notified_state"))return console.log("[PlatformServices] getRuntimeState - returning state handled by JS layer:",this.currentRuntimeState),this.currentRuntimeState;console.log("[PlatformServices] getRuntimeState - retrieving state handled by PL");var e=i.getRuntimeState();return console.log("[PlatformServices] getRuntimeState - returning PL state:",e),e};var c=n(49);r.addEventListener=function(e,t){c.getEventEmitter().on(e,t)},r.toggleLiveDTV=function(e){return i.toggleLiveDTV(e)},r.getLiveDTVStatus=function(){return i.getLiveDTVStatus()},r.getClockMillis=function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6},r.setReferenceDate=function(e){i.setReferenceDate(e)},r.on=r.addEventListener,r.loadScript=function(e){return global.ScriptLoader||(global.ScriptLoader=n(55).ScriptLoader),ScriptLoader.load(e)},r.restart=function(){if(console.log("[PlatformServices.restart] IN"),"function"==typeof i.restart)return console.log("[PlatformServices.restart] provided by engine"),i.restart();console.log("[PlatformServices.restart] not found in engine")},r.enableDTVEvents=function(){if("function"==typeof i.enableDTVEvents)return console.log("[PlatformServices.enableDTVEvents] provided by engine"),i.enableDTVEvents();console.log("[PlatformServices.enableDTVEvents] not found in engine")},r.enableOverlay=function(){if(r._overlayEnabled=!0,"function"==typeof i.enableOverlay)return console.log("[PlatformServices.enableOverlay] provided by engine"),i.enableOverlay();console.log("[PlatformServices.enableOverlay] not found in engine")},r.disableOverlay=function(){r._overlayEnabled=!1},r.isOverlayEnabled=function(){return r._overlayEnabled},r.openSocket=function(e,t){var n=new o.Socket,r={isOpen:!1,close:function(){this.isOpen=!1,n.close()},send:function(e){this.isOpen&&n.write(e)}},i=new a(r);return n.connect(t,e,function(){r.isOpen=!0,i.notify("connected")}),n.on("data",function(e){return i.notify("data",e)}),n.on("close",function(){r.isOpen=!1,i.notify("close")}),i},e.exports=r},function(e,t,n){function r(e){if(!(this instanceof r))return new r(e);a.call(this,e),c.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",i)}function i(){this.allowHalfOpen||this._writableState.ended||process.nextTick(this.end.bind(this))}e.exports=r;var o=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t},s=n(5);s.inherits=n(6);var a=n(16),c=n(18);s.inherits(r,a),function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}(o(c.prototype),function(e){r.prototype[e]||(r.prototype[e]=c.prototype[e])})},function(e,t){function n(e){return Array.isArray?Array.isArray(e):"[object Array]"===y(e)}function r(e){return"boolean"==typeof e}function i(e){return null===e}function o(e){return null==e}function s(e){return"number"==typeof e}function a(e){return"string"==typeof e}function c(e){return"symbol"===(void 0===e?"undefined":v(e))}function u(e){return void 0===e}function l(e){return"[object RegExp]"===y(e)}function f(e){return"object"===(void 0===e?"undefined":v(e))&&null!==e}function h(e){return"[object Date]"===y(e)}function p(e){return"[object Error]"===y(e)||e instanceof Error}function d(e){return"function"==typeof e}function g(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"===(void 0===e?"undefined":v(e))||void 0===e}function y(e){return Object.prototype.toString.call(e)}var v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.isArray=n,t.isBoolean=r,t.isNull=i,t.isNullOrUndefined=o,t.isNumber=s,t.isString=a,t.isSymbol=c,t.isUndefined=u,t.isRegExp=l,t.isObject=f,t.isDate=h,t.isError=p,t.isFunction=d,t.isPrimitive=g,t.isBuffer=Buffer.isBuffer},function(e,t,n){try{var r=n(8);if("function"!=typeof r.inherits)throw"";e.exports=r.inherits}catch(t){e.exports=n(41)}},function(e,t){e.exports=require("events")},function(e,t){e.exports=require("util")},function(e,t,n){var r,i;/*!
 * js-logger - http://github.com/jonnyreeves/js-logger
 * Jonny Reeves, http://jonnyreeves.co.uk/
 * js-logger may be freely distributed under the MIT license.
 */
!function(o){"use strict";var s={};s.VERSION="1.6.0";var a,c={},u=function(e,t){return function(){return t.apply(e,arguments)}},l=function(){var e,t,n=arguments,r=n[0];for(t=1;t<n.length;t++)for(e in n[t])e in r||!n[t].hasOwnProperty(e)||(r[e]=n[t][e]);return r},f=function(e,t){return{value:e,name:t}};s.TRACE=f(1,"TRACE"),s.DEBUG=f(2,"DEBUG"),s.INFO=f(3,"INFO"),s.TIME=f(4,"TIME"),s.WARN=f(5,"WARN"),s.ERROR=f(8,"ERROR"),s.OFF=f(99,"OFF");var h=function(e){this.context=e,this.setLevel(e.filterLevel),this.log=this.info};h.prototype={setLevel:function(e){e&&"value"in e&&(this.context.filterLevel=e)},getLevel:function(){return this.context.filterLevel},enabledFor:function(e){var t=this.context.filterLevel;return e.value>=t.value},trace:function(){this.invoke(s.TRACE,arguments)},debug:function(){this.invoke(s.DEBUG,arguments)},info:function(){this.invoke(s.INFO,arguments)},warn:function(){this.invoke(s.WARN,arguments)},error:function(){this.invoke(s.ERROR,arguments)},time:function(e){"string"==typeof e&&e.length>0&&this.invoke(s.TIME,[e,"start"])},timeEnd:function(e){"string"==typeof e&&e.length>0&&this.invoke(s.TIME,[e,"end"])},invoke:function(e,t){a&&this.enabledFor(e)&&a(t,l({level:e},this.context))}};var p=new h({filterLevel:s.OFF});!function(){var e=s;e.enabledFor=u(p,p.enabledFor),e.trace=u(p,p.trace),e.debug=u(p,p.debug),e.time=u(p,p.time),e.timeEnd=u(p,p.timeEnd),e.info=u(p,p.info),e.warn=u(p,p.warn),e.error=u(p,p.error),e.log=e.info}(),s.setHandler=function(e){a=e},s.setLevel=function(e){p.setLevel(e);for(var t in c)c.hasOwnProperty(t)&&c[t].setLevel(e)},s.getLevel=function(){return p.getLevel()},s.get=function(e){return c[e]||(c[e]=new h(l({name:e},p.context)))},s.createDefaultHandler=function(e){e=e||{},e.formatter=e.formatter||function(e,t){t.name&&e.unshift("["+t.name+"]")};var t={},n=function(e,t){Function.prototype.apply.call(e,console,t)};return"undefined"==typeof console?function(){}:function(r,i){r=Array.prototype.slice.call(r);var o,a=console.log;i.level===s.TIME?(o=(i.name?"["+i.name+"] ":"")+r[0],"start"===r[1]?console.time?console.time(o):t[o]=(new Date).getTime():console.timeEnd?console.timeEnd(o):n(a,[o+": "+((new Date).getTime()-t[o])+"ms"])):(i.level===s.WARN&&console.warn?a=console.warn:i.level===s.ERROR&&console.error?a=console.error:i.level===s.INFO&&console.info?a=console.info:i.level===s.DEBUG&&console.debug?a=console.debug:i.level===s.TRACE&&console.trace&&(a=console.trace),e.formatter(r,i),n(a,r))}},s.useDefaults=function(e){s.setLevel(e&&e.defaultLevel||s.DEBUG),s.setHandler(s.createDefaultHandler(e))},r=s,void 0!==(i="function"==typeof r?r.call(t,n,t,e):r)&&(e.exports=i)}()},function(e,t){e.exports=require("buffer")},function(e,t){e.exports=require("globoplay")},function(e,t,n){var r,i;/*!
 * js-logger - http://github.com/jonnyreeves/js-logger
 * Jonny Reeves, http://jonnyreeves.co.uk/
 * js-logger may be freely distributed under the MIT license.
 */
!function(o){"use strict";var s={};s.VERSION="1.6.0";var a,c={},u=function(e,t){return function(){return t.apply(e,arguments)}},l=function(){var e,t,n=arguments,r=n[0];for(t=1;t<n.length;t++)for(e in n[t])e in r||!n[t].hasOwnProperty(e)||(r[e]=n[t][e]);return r},f=function(e,t){return{value:e,name:t}};s.TRACE=f(1,"TRACE"),s.DEBUG=f(2,"DEBUG"),s.INFO=f(3,"INFO"),s.TIME=f(4,"TIME"),s.WARN=f(5,"WARN"),s.ERROR=f(8,"ERROR"),s.OFF=f(99,"OFF");var h=function(e){this.context=e,this.setLevel(e.filterLevel),this.log=this.info};h.prototype={setLevel:function(e){e&&"value"in e&&(this.context.filterLevel=e)},getLevel:function(){return this.context.filterLevel},enabledFor:function(e){var t=this.context.filterLevel;return e.value>=t.value},trace:function(){this.invoke(s.TRACE,arguments)},debug:function(){this.invoke(s.DEBUG,arguments)},info:function(){this.invoke(s.INFO,arguments)},warn:function(){this.invoke(s.WARN,arguments)},error:function(){this.invoke(s.ERROR,arguments)},time:function(e){"string"==typeof e&&e.length>0&&this.invoke(s.TIME,[e,"start"])},timeEnd:function(e){"string"==typeof e&&e.length>0&&this.invoke(s.TIME,[e,"end"])},invoke:function(e,t){a&&this.enabledFor(e)&&a(t,l({level:e},this.context))}};var p=new h({filterLevel:s.OFF});!function(){var e=s;e.enabledFor=u(p,p.enabledFor),e.trace=u(p,p.trace),e.debug=u(p,p.debug),e.time=u(p,p.time),e.timeEnd=u(p,p.timeEnd),e.info=u(p,p.info),e.warn=u(p,p.warn),e.error=u(p,p.error),e.log=e.info}(),s.setHandler=function(e){a=e},s.setLevel=function(e){p.setLevel(e);for(var t in c)c.hasOwnProperty(t)&&c[t].setLevel(e)},s.getLevel=function(){return p.getLevel()},s.get=function(e){return c[e]||(c[e]=new h(l({name:e},p.context)))},s.createDefaultHandler=function(e){e=e||{},e.formatter=e.formatter||function(e,t){t.name&&e.unshift("["+t.name+"]")};var t={},n=function(e,t){Function.prototype.apply.call(e,console,t)};return"undefined"==typeof console?function(){}:function(r,i){r=Array.prototype.slice.call(r);var o,a=console.log;i.level===s.TIME?(o=(i.name?"["+i.name+"] ":"")+r[0],"start"===r[1]?console.time?console.time(o):t[o]=(new Date).getTime():console.timeEnd?console.timeEnd(o):n(a,[o+": "+((new Date).getTime()-t[o])+"ms"])):(i.level===s.WARN&&console.warn?a=console.warn:i.level===s.ERROR&&console.error?a=console.error:i.level===s.INFO&&console.info?a=console.info:i.level===s.DEBUG&&console.debug?a=console.debug:i.level===s.TRACE&&console.trace&&(a=console.trace),e.formatter(r,i),n(a,r))}},s.useDefaults=function(e){s.setLevel(e&&e.defaultLevel||s.DEBUG),s.setHandler(s.createDefaultHandler(e))},r=s,void 0!==(i="function"==typeof r?r.call(t,n,t,e):r)&&(e.exports=i)}()},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(0);e.exports=function(e){if(null===e||"object"!==(void 0===e?"undefined":r(e)))return e;if(e instanceof Object)var t={__proto__:e.__proto__};else var t=Object.create(null);return Object.getOwnPropertyNames(e).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}),t}(i)},function(e,t,n){function r(){}function i(e){function t(e,t,n){function r(e,t,n){return m(e,t,function(i){!i||"EMFILE"!==i.code&&"ENFILE"!==i.code?("function"==typeof n&&n.apply(this,arguments),s()):o([r,[e,t,n]])})}return"function"==typeof t&&(n=t,t=null),r(e,t,n)}function n(e,t,n,r){function i(e,t,n,r){return b(e,t,n,function(a){!a||"EMFILE"!==a.code&&"ENFILE"!==a.code?("function"==typeof r&&r.apply(this,arguments),s()):o([i,[e,t,n,r]])})}return"function"==typeof n&&(r=n,n=null),i(e,t,n,r)}function r(e,t,n,r){function i(e,t,n,r){return _(e,t,n,function(a){!a||"EMFILE"!==a.code&&"ENFILE"!==a.code?("function"==typeof r&&r.apply(this,arguments),s()):o([i,[e,t,n,r]])})}return"function"==typeof n&&(r=n,n=null),i(e,t,n,r)}function a(e,t,n){function r(e,t){t&&t.sort&&t.sort(),!e||"EMFILE"!==e.code&&"ENFILE"!==e.code?("function"==typeof n&&n.apply(this,arguments),s()):o([l,[i]])}var i=[e];return"function"!=typeof t?i.push(t):n=t,i.push(r),l(i)}function l(t){return w.apply(e,t)}function f(e,t){return this instanceof f?(S.apply(this,arguments),this):f.apply(Object.create(f.prototype),arguments)}function h(){var e=this;v(e.path,e.flags,e.mode,function(t,n){t?(e.autoClose&&e.destroy(),e.emit("error",t)):(e.fd=n,e.emit("open",n),e.read())})}function p(e,t){return this instanceof p?(E.apply(this,arguments),this):p.apply(Object.create(p.prototype),arguments)}function d(){var e=this;v(e.path,e.flags,e.mode,function(t,n){t?(e.destroy(),e.emit("error",t)):(e.fd=n,e.emit("open",n))})}function g(e,t){return new f(e,t)}function y(e,t){return new p(e,t)}function v(e,t,n,r){function i(e,t,n,r){return L(e,t,n,function(a,c){!a||"EMFILE"!==a.code&&"ENFILE"!==a.code?("function"==typeof r&&r.apply(this,arguments),s()):o([i,[e,t,n,r]])})}return"function"==typeof n&&(r=n,n=null),i(e,t,n,r)}c(e),e.gracefulify=i,e.FileReadStream=f,e.FileWriteStream=p,e.createReadStream=g,e.createWriteStream=y;var m=e.readFile;e.readFile=t;var b=e.writeFile;e.writeFile=n;var _=e.appendFile;_&&(e.appendFile=r);var w=e.readdir;if(e.readdir=a,"v0.8"===process.version.substr(0,4)){var k=u(e);f=k.ReadStream,p=k.WriteStream}var S=e.ReadStream;f.prototype=Object.create(S.prototype),f.prototype.open=h;var E=e.WriteStream;p.prototype=Object.create(E.prototype),p.prototype.open=d,e.ReadStream=f,e.WriteStream=p;var L=e.open;return e.open=v,e}function o(e){h("ENQUEUE",e[0].name,e[1]),l.push(e)}function s(){var e=l.shift();e&&(h("RETRY",e[0].name,e[1]),e[0].apply(null,e[1]))}var a=n(0),c=n(40),u=n(39),l=[],f=n(8),h=r;f.debuglog?h=f.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(h=function(){var e=f.format.apply(f,arguments);e="GFS4: "+e.split(/\n/).join("\nGFS4: "),console.error(e)}),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){h(l),n(60).equal(l.length,0)}),e.exports=i(n(13)),process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&(e.exports=i(a)),e.exports.close=a.close=function(e){return function(t,n){return e.call(a,t,function(e){e||s(),"function"==typeof n&&n.apply(this,arguments)})}}(a.close),e.exports.closeSync=a.closeSync=function(e){return function(t){var n=e.apply(a,arguments);return s(),n}}(a.closeSync)},function(e,t,n){(function(e){var r,i,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};/*!
 *
 * Copyright 2009-2017 Kris Kowal under the terms of the MIT
 * license found at https://github.com/kriskowal/q/blob/v1/LICENSE
 *
 * With parts by Tyler Close
 * Copyright 2007-2009 Tyler Close under the terms of the MIT X license found
 * at http://www.opensource.org/licenses/mit-license.html
 * Forked at ref_send.js version: 2009-05-11
 *
 * With parts by Mark Miller
 * Copyright (C) 2011 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */
!function(s){"use strict";if("function"==typeof bootstrap)bootstrap("promise",s);else if("object"===o(t)&&"object"===o(e))e.exports=s();else{r=s,void 0!==(i="function"==typeof r?r.call(t,n,t,e):r)&&(e.exports=i)}}(function(){"use strict";function e(e){return function(){return Y.apply(e,arguments)}}function t(e){return e===Object(e)}function n(e){return"[object StopIteration]"===ne(e)||e instanceof W}function r(e,t){if(z&&t.stack&&"object"===(void 0===e?"undefined":o(e))&&null!==e&&e.stack){for(var n=[],r=t;r;r=r.source)r.stack&&(!e.__minimumStackCounter__||e.__minimumStackCounter__>r.stackCounter)&&($(e,"__minimumStackCounter__",{value:r.stackCounter,configurable:!0}),n.unshift(r.stack));n.unshift(e.stack);var s=n.join("\n"+re+"\n"),a=i(s);$(e,"stack",{value:a,configurable:!0})}}function i(e){for(var t=e.split("\n"),n=[],r=0;r<t.length;++r){var i=t[r];c(i)||s(i)||!i||n.push(i)}return n.join("\n")}function s(e){return-1!==e.indexOf("(module.js:")||-1!==e.indexOf("(node.js:")}function a(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t)return[t[1],+t[2]];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(n)return[n[1],+n[2]];var r=/.*@(.+):(\d+)$/.exec(e);return r?[r[1],+r[2]]:void 0}function c(e){var t=a(e);if(!t)return!1;var n=t[0],r=t[1];return n===V&&r>=H&&r<=ue}function u(){if(z)try{throw Error()}catch(r){var e=r.stack.split("\n"),t=e[0].indexOf("@")>0?e[1]:e[2],n=a(t);if(!n)return;return V=n[0],n[1]}}function l(e){return e instanceof d?e:m(e)?x(e):R(e)}function f(){function e(e){t=e,l.longStackSupport&&z&&(o.source=e),J(n,function(t,n){l.nextTick(function(){e.promiseDispatch.apply(e,n)})},void 0),n=void 0,r=void 0}var t,n=[],r=[],i=Z(f.prototype),o=Z(d.prototype);if(o.promiseDispatch=function(e,i,o){var s=K(arguments);n?(n.push(s),"when"===i&&o[1]&&r.push(o[1])):l.nextTick(function(){t.promiseDispatch.apply(t,s)})},o.valueOf=function(){if(n)return o;var e=y(t);return v(e)&&(t=e),e},o.inspect=function(){return t?t.inspect():{state:"pending"}},l.longStackSupport&&z)try{throw Error()}catch(e){o.stack=e.stack.substring(e.stack.indexOf("\n")+1),o.stackCounter=ie++}return i.promise=o,i.resolve=function(n){t||e(l(n))},i.fulfill=function(n){t||e(R(n))},i.reject=function(n){t||e(L(n))},i.notify=function(e){t||J(r,function(t,n){l.nextTick(function(){n(e)})},void 0)},i}function h(e){if("function"!=typeof e)throw new TypeError("resolver must be a function.");var t=f();try{e(t.resolve,t.reject,t.notify)}catch(e){t.reject(e)}return t.promise}function p(e){return h(function(t,n){for(var r=0,i=e.length;r<i;r++)l(e[r]).then(t,n)})}function d(e,t,n){void 0===t&&(t=function(e){return L(Error("Promise does not support operation: "+e))}),void 0===n&&(n=function(){return{state:"unknown"}});var r=Z(d.prototype);if(r.promiseDispatch=function(n,i,o){var s;try{s=e[i]?e[i].apply(r,o):t.call(r,i,o)}catch(e){s=L(e)}n&&n(s)},r.inspect=n,n){var i=n();"rejected"===i.state&&(r.exception=i.reason),r.valueOf=function(){var e=n();return"pending"===e.state||"rejected"===e.state?r:e.value}}return r}function g(e,t,n,r){return l(e).then(t,n,r)}function y(e){if(v(e)){var t=e.inspect();if("fulfilled"===t.state)return t.value}return e}function v(e){return e instanceof d}function m(e){return t(e)&&"function"==typeof e.then}function b(e){return v(e)&&"pending"===e.inspect().state}function _(e){return!v(e)||"fulfilled"===e.inspect().state}function w(e){return v(e)&&"rejected"===e.inspect().state}function k(){oe.length=0,se.length=0,ce||(ce=!0)}function S(e,t){ce&&("object"===("undefined"==typeof process?"undefined":o(process))&&"function"==typeof process.emit&&l.nextTick.runAfter(function(){-1!==Q(se,e)&&(process.emit("unhandledRejection",t,e),ae.push(e))}),se.push(e),t&&void 0!==t.stack?oe.push(t.stack):oe.push("(no stack) "+t))}function E(e){if(ce){var t=Q(se,e);-1!==t&&("object"===("undefined"==typeof process?"undefined":o(process))&&"function"==typeof process.emit&&l.nextTick.runAfter(function(){var n=Q(ae,e);-1!==n&&(process.emit("rejectionHandled",oe[t],e),ae.splice(n,1))}),se.splice(t,1),oe.splice(t,1))}}function L(e){var t=d({when:function(t){return t&&E(this),t?t(e):this}},function(){return this},function(){return{state:"rejected",reason:e}});return S(t,e),t}function R(e){return d({when:function(){return e},get:function(t){return e[t]},set:function(t,n){e[t]=n},delete:function(t){delete e[t]},post:function(t,n){return null===t||void 0===t?e.apply(void 0,n):e[t].apply(e,n)},apply:function(t,n){return e.apply(t,n)},keys:function(){return te(e)}},void 0,function(){return{state:"fulfilled",value:e}})}function x(e){var t=f();return l.nextTick(function(){try{e.then(t.resolve,t.reject,t.notify)}catch(e){t.reject(e)}}),t.promise}function O(e){return d({isDef:function(){}},function(t,n){return N(e,t,n)},function(){return l(e).inspect()})}function F(e,t,n){return l(e).spread(t,n)}function P(e){return function(){function t(e,t){var s;if("undefined"==typeof StopIteration){try{s=r[e](t)}catch(e){return L(e)}return s.done?l(s.value):g(s.value,i,o)}try{s=r[e](t)}catch(e){return n(e)?l(e.value):L(e)}return g(s,i,o)}var r=e.apply(this,arguments),i=t.bind(t,"next"),o=t.bind(t,"throw");return i()}}function T(e){l.done(l.async(e)())}function D(e){throw new W(e)}function C(e){return function(){return F([this,j(arguments)],function(t,n){return e.apply(t,n)})}}function N(e,t,n){return l(e).dispatch(t,n)}function j(e){return g(e,function(e){var t=0,n=f();return J(e,function(r,i,o){var s;v(i)&&"fulfilled"===(s=i.inspect()).state?e[o]=s.value:(++t,g(i,function(r){e[o]=r,0==--t&&n.resolve(e)},n.reject,function(e){n.notify({index:o,value:e})}))},void 0),0===t&&n.resolve(e),n.promise})}function A(e){if(0===e.length)return l.resolve();var t=l.defer(),n=0;return J(e,function(r,i,o){function s(e){t.resolve(e)}function a(e){0===--n&&(e.message="Q can't get fulfillment value from any promise, all promises were rejected. Last error message: "+e.message,t.reject(e))}function c(e){t.notify({index:o,value:e})}var u=e[o];n++,g(u,s,a,c)},void 0),t.promise}function I(e){return g(e,function(e){return e=X(e,l),g(j(X(e,function(e){return g(e,q,q)})),function(){return e})})}function M(e){return l(e).allSettled()}function U(e,t){return l(e).then(void 0,void 0,t)}function B(e,t){return l(e).nodeify(t)}var z=!1;try{throw Error()}catch(e){z=!!e.stack}var V,W,H=u(),q=function(){},G=function(){function e(){for(var e,r;n.next;)n=n.next,e=n.task,n.task=void 0,r=n.domain,r&&(n.domain=void 0,r.enter()),t(e,r);for(;c.length;)e=c.pop(),t(e);i=!1}function t(t,n){try{t()}catch(t){if(a)throw n&&n.exit(),setTimeout(e,0),n&&n.enter(),t;setTimeout(function(){throw t},0)}n&&n.exit()}var n={task:void 0,next:null},r=n,i=!1,s=void 0,a=!1,c=[];if(G=function(e){r=r.next={task:e,domain:a&&process.domain,next:null},i||(i=!0,s())},"object"===("undefined"==typeof process?"undefined":o(process))&&""+process=="[object process]"&&process.nextTick)a=!0,s=function(){process.nextTick(e)};else if("function"==typeof setImmediate)s="undefined"!=typeof window?setImmediate.bind(window,e):function(){setImmediate(e)};else if("undefined"!=typeof MessageChannel){var u=new MessageChannel;u.port1.onmessage=function(){s=l,u.port1.onmessage=e,e()};var l=function(){u.port2.postMessage(0)};s=function(){setTimeout(e,0),l()}}else s=function(){setTimeout(e,0)};return G.runAfter=function(e){c.push(e),i||(i=!0,s())},G}(),Y=Function.call,K=e(Array.prototype.slice),J=e(Array.prototype.reduce||function(e,t){var n=0,r=this.length;if(1===arguments.length)for(;;){if(n in this){t=this[n++];break}if(++n>=r)throw new TypeError}for(;n<r;n++)n in this&&(t=e(t,this[n],n));return t}),Q=e(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),X=e(Array.prototype.map||function(e,t){var n=this,r=[];return J(n,function(i,o,s){r.push(e.call(t,o,s,n))},void 0),r}),Z=Object.create||function(e){function t(){}return t.prototype=e,new t},$=Object.defineProperty||function(e,t,n){return e[t]=n.value,e},ee=e(Object.prototype.hasOwnProperty),te=Object.keys||function(e){var t=[];for(var n in e)ee(e,n)&&t.push(n);return t},ne=e(Object.prototype.toString);W="undefined"!=typeof ReturnValue?ReturnValue:function(e){this.value=e};var re="From previous event:";l.resolve=l,l.nextTick=G,l.longStackSupport=!1;var ie=1;"object"===("undefined"==typeof process?"undefined":o(process))&&process&&process.env&&process.env.Q_DEBUG&&(l.longStackSupport=!0),l.defer=f,f.prototype.makeNodeResolver=function(){var e=this;return function(t,n){t?e.reject(t):arguments.length>2?e.resolve(K(arguments,1)):e.resolve(n)}},l.Promise=h,l.promise=h,h.race=p,h.all=j,h.reject=L,h.resolve=l,l.passByCopy=function(e){return e},d.prototype.passByCopy=function(){return this},l.join=function(e,t){return l(e).join(t)},d.prototype.join=function(e){return l([this,e]).spread(function(e,t){if(e===t)return e;throw Error("Q can't join: not the same: "+e+" "+t)})},l.race=p,d.prototype.race=function(){return this.then(l.race)},l.makePromise=d,d.prototype.toString=function(){return"[object Promise]"},d.prototype.then=function(e,t,n){function i(t){try{return"function"==typeof e?e(t):t}catch(e){return L(e)}}function o(e){if("function"==typeof t){r(e,a);try{return t(e)}catch(e){return L(e)}}return L(e)}function s(e){return"function"==typeof n?n(e):e}var a=this,c=f(),u=!1;return l.nextTick(function(){a.promiseDispatch(function(e){u||(u=!0,c.resolve(i(e)))},"when",[function(e){u||(u=!0,c.resolve(o(e)))}])}),a.promiseDispatch(void 0,"when",[void 0,function(e){var t,n=!1;try{t=s(e)}catch(e){if(n=!0,!l.onerror)throw e;l.onerror(e)}n||c.notify(t)}]),c.promise},l.tap=function(e,t){return l(e).tap(t)},d.prototype.tap=function(e){return e=l(e),this.then(function(t){return e.fcall(t).thenResolve(t)})},l.when=g,d.prototype.thenResolve=function(e){return this.then(function(){return e})},l.thenResolve=function(e,t){return l(e).thenResolve(t)},d.prototype.thenReject=function(e){return this.then(function(){throw e})},l.thenReject=function(e,t){return l(e).thenReject(t)},l.nearer=y,l.isPromise=v,l.isPromiseAlike=m,l.isPending=b,d.prototype.isPending=function(){return"pending"===this.inspect().state},l.isFulfilled=_,d.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},l.isRejected=w,d.prototype.isRejected=function(){return"rejected"===this.inspect().state};var oe=[],se=[],ae=[],ce=!0;l.resetUnhandledRejections=k,l.getUnhandledReasons=function(){return oe.slice()},l.stopUnhandledRejectionTracking=function(){k(),ce=!1},k(),l.reject=L,l.fulfill=R,l.master=O,l.spread=F,d.prototype.spread=function(e,t){return this.all().then(function(t){return e.apply(void 0,t)},t)},l.async=P,l.spawn=T,l.return=D,l.promised=C,l.dispatch=N,d.prototype.dispatch=function(e,t){var n=this,r=f();return l.nextTick(function(){n.promiseDispatch(r.resolve,e,t)}),r.promise},l.get=function(e,t){return l(e).dispatch("get",[t])},d.prototype.get=function(e){return this.dispatch("get",[e])},l.set=function(e,t,n){return l(e).dispatch("set",[t,n])},d.prototype.set=function(e,t){return this.dispatch("set",[e,t])},l.del=l.delete=function(e,t){return l(e).dispatch("delete",[t])},d.prototype.del=d.prototype.delete=function(e){return this.dispatch("delete",[e])},l.mapply=l.post=function(e,t,n){return l(e).dispatch("post",[t,n])},d.prototype.mapply=d.prototype.post=function(e,t){return this.dispatch("post",[e,t])},l.send=l.mcall=l.invoke=function(e,t){return l(e).dispatch("post",[t,K(arguments,2)])},d.prototype.send=d.prototype.mcall=d.prototype.invoke=function(e){return this.dispatch("post",[e,K(arguments,1)])},l.fapply=function(e,t){return l(e).dispatch("apply",[void 0,t])},d.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])},l.try=l.fcall=function(e){return l(e).dispatch("apply",[void 0,K(arguments,1)])},d.prototype.fcall=function(){return this.dispatch("apply",[void 0,K(arguments)])},l.fbind=function(e){var t=l(e),n=K(arguments,1);return function(){return t.dispatch("apply",[this,n.concat(K(arguments))])}},d.prototype.fbind=function(){var e=this,t=K(arguments);return function(){return e.dispatch("apply",[this,t.concat(K(arguments))])}},l.keys=function(e){return l(e).dispatch("keys",[])},d.prototype.keys=function(){return this.dispatch("keys",[])},l.all=j,d.prototype.all=function(){return j(this)},l.any=A,d.prototype.any=function(){return A(this)},l.allResolved=function(e,t,n){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t+" is deprecated, use "+n+" instead.",Error("").stack),e.apply(e,arguments)}}(I,"allResolved","allSettled"),d.prototype.allResolved=function(){return I(this)},l.allSettled=M,d.prototype.allSettled=function(){return this.then(function(e){return j(X(e,function(e){function t(){return e.inspect()}return e=l(e),e.then(t,t)}))})},l.fail=l.catch=function(e,t){return l(e).then(void 0,t)},d.prototype.fail=d.prototype.catch=function(e){return this.then(void 0,e)},l.progress=U,d.prototype.progress=function(e){return this.then(void 0,void 0,e)},l.fin=l.finally=function(e,t){return l(e).finally(t)},d.prototype.fin=d.prototype.finally=function(e){if(!e||"function"!=typeof e.apply)throw Error("Q can't apply finally callback");return e=l(e),this.then(function(t){return e.fcall().then(function(){return t})},function(t){return e.fcall().then(function(){throw t})})},l.done=function(e,t,n,r){return l(e).done(t,n,r)},d.prototype.done=function(e,t,n){var i=function(e){l.nextTick(function(){if(r(e,s),!l.onerror)throw e;l.onerror(e)})},s=e||t||n?this.then(e,t,n):this;"object"===("undefined"==typeof process?"undefined":o(process))&&process&&process.domain&&(i=process.domain.bind(i)),s.then(void 0,i)},l.timeout=function(e,t,n){return l(e).timeout(t,n)},d.prototype.timeout=function(e,t){var n=f(),r=setTimeout(function(){t&&"string"!=typeof t||(t=Error(t||"Timed out after "+e+" ms"),t.code="ETIMEDOUT"),n.reject(t)},e);return this.then(function(e){clearTimeout(r),n.resolve(e)},function(e){clearTimeout(r),n.reject(e)},n.notify),n.promise},l.delay=function(e,t){return void 0===t&&(t=e,e=void 0),l(e).delay(t)},d.prototype.delay=function(e){return this.then(function(t){var n=f();return setTimeout(function(){n.resolve(t)},e),n.promise})},l.nfapply=function(e,t){return l(e).nfapply(t)},d.prototype.nfapply=function(e){var t=f(),n=K(e);return n.push(t.makeNodeResolver()),this.fapply(n).fail(t.reject),t.promise},l.nfcall=function(e){var t=K(arguments,1);return l(e).nfapply(t)},d.prototype.nfcall=function(){var e=K(arguments),t=f();return e.push(t.makeNodeResolver()),this.fapply(e).fail(t.reject),t.promise},l.nfbind=l.denodeify=function(e){if(void 0===e)throw Error("Q can't wrap an undefined function");var t=K(arguments,1);return function(){var n=t.concat(K(arguments)),r=f();return n.push(r.makeNodeResolver()),l(e).fapply(n).fail(r.reject),r.promise}},d.prototype.nfbind=d.prototype.denodeify=function(){var e=K(arguments);return e.unshift(this),l.denodeify.apply(void 0,e)},l.nbind=function(e,t){var n=K(arguments,2);return function(){function r(){return e.apply(t,arguments)}var i=n.concat(K(arguments)),o=f();return i.push(o.makeNodeResolver()),l(r).fapply(i).fail(o.reject),o.promise}},d.prototype.nbind=function(){var e=K(arguments,0);return e.unshift(this),l.nbind.apply(void 0,e)},l.nmapply=l.npost=function(e,t,n){return l(e).npost(t,n)},d.prototype.nmapply=d.prototype.npost=function(e,t){var n=K(t||[]),r=f();return n.push(r.makeNodeResolver()),this.dispatch("post",[e,n]).fail(r.reject),r.promise},l.nsend=l.nmcall=l.ninvoke=function(e,t){var n=K(arguments,2),r=f();return n.push(r.makeNodeResolver()),l(e).dispatch("post",[t,n]).fail(r.reject),r.promise},d.prototype.nsend=d.prototype.nmcall=d.prototype.ninvoke=function(e){var t=K(arguments,1),n=f();return t.push(n.makeNodeResolver()),this.dispatch("post",[e,t]).fail(n.reject),n.promise},l.nodeify=B,d.prototype.nodeify=function(e){if(!e)return this;this.then(function(t){l.nextTick(function(){e(null,t)})},function(t){l.nextTick(function(){e(t)})})},l.noConflict=function(){throw Error("Q.noConflict only works when Q is used as a global")};var ue=u();return l})}).call(t,n(29)(e))},function(e,t,n){function r(e,t){var r=n(4);e=e||{};var i=e.highWaterMark,o=e.objectMode?16:16384;this.highWaterMark=i||0===i?i:o,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!e.objectMode,t instanceof r&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(O||(O=n(19).StringDecoder),this.decoder=new O(e.encoding),this.encoding=e.encoding)}function i(e){n(4);if(!(this instanceof i))return new i(e);this._readableState=new r(e,this),this.readable=!0,R.call(this)}function o(e,t,n,r,i){var o=u(t,n);if(o)e.emit("error",o);else if(x.isNullOrUndefined(n))t.reading=!1,t.ended||l(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!i){var a=Error("stream.push() after EOF");e.emit("error",a)}else if(t.endEmitted&&i){var a=Error("stream.unshift() after end event");e.emit("error",a)}else!t.decoder||i||r||(n=t.decoder.write(n)),i||(t.reading=!1),t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&f(e)),p(e,t);else i||(t.reading=!1);return s(t)}function s(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function a(e){if(e>=P)e=P;else{e--;for(var t=1;t<32;t<<=1)e|=e>>t;e++}return e}function c(e,t){return 0===t.length&&t.ended?0:t.objectMode?0===e?0:1:isNaN(e)||x.isNull(e)?t.flowing&&t.buffer.length?t.buffer[0].length:t.length:e<=0?0:(e>t.highWaterMark&&(t.highWaterMark=a(e)),e>t.length?t.ended?t.length:(t.needReadable=!0,0):e)}function u(e,t){var n=null;return x.isBuffer(t)||x.isString(t)||x.isNullOrUndefined(t)||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function l(e,t){if(t.decoder&&!t.ended){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,f(e)}function f(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(F("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?process.nextTick(function(){h(e)}):h(e))}function h(e){F("emit readable"),e.emit("readable"),m(e)}function p(e,t){t.readingMore||(t.readingMore=!0,process.nextTick(function(){d(e,t)}))}function d(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(F("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function g(e){return function(){var t=e._readableState;F("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&L.listenerCount(e,"data")&&(t.flowing=!0,m(e))}}function y(e,t){t.resumeScheduled||(t.resumeScheduled=!0,process.nextTick(function(){v(e,t)}))}function v(e,t){t.resumeScheduled=!1,e.emit("resume"),m(e),t.flowing&&!t.reading&&e.read(0)}function m(e){var t=e._readableState;if(F("flow",t.flowing),t.flowing)do{var n=e.read()}while(null!==n&&t.flowing)}function b(e,t){var n,r=t.buffer,i=t.length,o=!!t.decoder,s=!!t.objectMode;if(0===r.length)return null;if(0===i)n=null;else if(s)n=r.shift();else if(!e||e>=i)n=o?r.join(""):E.concat(r,i),r.length=0;else if(e<r[0].length){var a=r[0];n=a.slice(0,e),r[0]=a.slice(e)}else if(e===r[0].length)n=r.shift();else{n=o?"":new E(e);for(var c=0,u=0,l=r.length;u<l&&c<e;u++){var a=r[0],f=Math.min(e-c,a.length);o?n+=a.slice(0,f):a.copy(n,c,0,f),f<a.length?r[0]=a.slice(f):r.shift(),c+=f}}return n}function _(e){var t=e._readableState;if(t.length>0)throw Error("endReadable called on non-empty stream");t.endEmitted||(t.ended=!0,process.nextTick(function(){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}))}function w(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}function k(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}e.exports=i;var S=n(42),E=n(10).Buffer;i.ReadableState=r;var L=n(7).EventEmitter;L.listenerCount||(L.listenerCount=function(e,t){return e.listeners(t).length});var R=n(1),x=n(5);x.inherits=n(6);var O,F=n(8);F=F&&F.debuglog?F.debuglog("stream"):function(){},x.inherits(i,R),i.prototype.push=function(e,t){var n=this._readableState;return x.isString(e)&&!n.objectMode&&(t=t||n.defaultEncoding)!==n.encoding&&(e=new E(e,t),t=""),o(this,n,e,t,!1)},i.prototype.unshift=function(e){return o(this,this._readableState,e,"",!0)},i.prototype.setEncoding=function(e){return O||(O=n(19).StringDecoder),this._readableState.decoder=new O(e),this._readableState.encoding=e,this};var P=8388608;i.prototype.read=function(e){F("read",e);var t=this._readableState,n=e;if((!x.isNumber(e)||e>0)&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return F("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?_(this):f(this),null;if(0===(e=c(e,t))&&t.ended)return 0===t.length&&_(this),null;var r=t.needReadable;F("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&(r=!0,F("length less than watermark",r)),(t.ended||t.reading)&&(r=!1,F("reading or ended",r)),r&&(F("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1),r&&!t.reading&&(e=c(n,t));var i;return i=e>0?b(e,t):null,x.isNull(i)&&(t.needReadable=!0,e=0),t.length-=e,0!==t.length||t.ended||(t.needReadable=!0),n!==e&&t.ended&&0===t.length&&_(this),x.isNull(i)||this.emit("data",i),i},i.prototype._read=function(e){this.emit("error",Error("not implemented"))},i.prototype.pipe=function(e,t){function n(e){F("onunpipe"),e===l&&i()}function r(){F("onend"),e.end()}function i(){F("cleanup"),e.removeListener("close",a),e.removeListener("finish",c),e.removeListener("drain",d),e.removeListener("error",s),e.removeListener("unpipe",n),l.removeListener("end",r),l.removeListener("end",i),l.removeListener("data",o),!f.awaitDrain||e._writableState&&!e._writableState.needDrain||d()}function o(t){F("ondata"),!1===e.write(t)&&(F("false write response, pause",l._readableState.awaitDrain),l._readableState.awaitDrain++,l.pause())}function s(t){F("onerror",t),u(),e.removeListener("error",s),0===L.listenerCount(e,"error")&&e.emit("error",t)}function a(){e.removeListener("finish",c),u()}function c(){F("onfinish"),e.removeListener("close",a),u()}function u(){F("unpipe"),l.unpipe(e)}var l=this,f=this._readableState;switch(f.pipesCount){case 0:f.pipes=e;break;case 1:f.pipes=[f.pipes,e];break;default:f.pipes.push(e)}f.pipesCount+=1,F("pipe count=%d opts=%j",f.pipesCount,t);var h=(!t||!1!==t.end)&&e!==process.stdout&&e!==process.stderr,p=h?r:i;f.endEmitted?process.nextTick(p):l.once("end",p),e.on("unpipe",n);var d=g(l);return e.on("drain",d),l.on("data",o),e._events&&e._events.error?S(e._events.error)?e._events.error.unshift(s):e._events.error=[s,e._events.error]:e.on("error",s),e.once("close",a),e.once("finish",c),e.emit("pipe",l),f.flowing||(F("pipe resume"),l.resume()),e},i.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<r;i++)n[i].emit("unpipe",this);return this}var i=k(t.pipes,e);return-1===i?this:(t.pipes.splice(i,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},i.prototype.on=function(e,t){var n=R.prototype.on.call(this,e,t);if("data"===e&&!1!==this._readableState.flowing&&this.resume(),"readable"===e&&this.readable){var r=this._readableState;if(!r.readableListening)if(r.readableListening=!0,r.emittedReadable=!1,r.needReadable=!0,r.reading)r.length&&f(this);else{var i=this;process.nextTick(function(){F("readable nexttick read 0"),i.read(0)})}}return n},i.prototype.addListener=i.prototype.on,i.prototype.resume=function(){var e=this._readableState;return e.flowing||(F("resume"),e.flowing=!0,e.reading||(F("resume read 0"),this.read(0)),y(this,e)),this},i.prototype.pause=function(){return F("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(F("pause"),this._readableState.flowing=!1,this.emit("pause")),this},i.prototype.wrap=function(e){var t=this._readableState,n=!1,r=this;e.on("end",function(){if(F("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function(i){if(F("wrapped data"),t.decoder&&(i=t.decoder.write(i)),i&&(t.objectMode||i.length)){r.push(i)||(n=!0,e.pause())}});for(var i in e)x.isFunction(e[i])&&x.isUndefined(this[i])&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));return w(["error","close","destroy","pause","resume"],function(t){e.on(t,r.emit.bind(r,t))}),r._read=function(t){F("wrapped _read",t),n&&(n=!1,e.resume())},r},i._fromList=b},function(e,t,n){function r(e,t){this.afterTransform=function(e,n){return i(t,e,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function i(e,t,n){var r=e._transformState;r.transforming=!1;var i=r.writecb;if(!i)return e.emit("error",Error("no writecb in Transform class"));r.writechunk=null,r.writecb=null,c.isNullOrUndefined(n)||e.push(n),i&&i(t);var o=e._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&e._read(o.highWaterMark)}function o(e){if(!(this instanceof o))return new o(e);a.call(this,e),this._transformState=new r(e,this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("prefinish",function(){c.isFunction(this._flush)?this._flush(function(e){s(t,e)}):s(t)})}function s(e,t){if(t)return e.emit("error",t);var n=e._writableState,r=e._transformState;if(n.length)throw Error("calling transform done when ws.length != 0");if(r.transforming)throw Error("calling transform done when still transforming");return e.push(null)}e.exports=o;var a=n(4),c=n(5);c.inherits=n(6),c.inherits(o,a),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,a.prototype.push.call(this,e,t)},o.prototype._transform=function(e,t,n){throw Error("not implemented")},o.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(e){var t=this._transformState;c.isNull(t.writechunk)||!t.writecb||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))}},function(e,t,n){function r(e,t,n){this.chunk=e,this.encoding=t,this.callback=n}function i(e,t){var r=n(4);e=e||{};var i=e.highWaterMark,o=e.objectMode?16:16384;this.highWaterMark=i||0===i?i:o,this.objectMode=!!e.objectMode,t instanceof r&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var s=!1===e.decodeStrings;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){p(t,e)},this.writecb=null,this.writelen=0,this.buffer=[],this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1}function o(e){var t=n(4);if(!(this instanceof o||this instanceof t))return new o(e);this._writableState=new i(e,this),this.writable=!0,S.call(this)}function s(e,t,n){var r=Error("write after end");e.emit("error",r),process.nextTick(function(){n(r)})}function a(e,t,n,r){var i=!0;if(!(k.isBuffer(n)||k.isString(n)||k.isNullOrUndefined(n)||t.objectMode)){var o=new TypeError("Invalid non-string/buffer chunk");e.emit("error",o),process.nextTick(function(){r(o)}),i=!1}return i}function c(e,t,n){return!e.objectMode&&!1!==e.decodeStrings&&k.isString(t)&&(t=new w(t,n)),t}function u(e,t,n,i,o){n=c(t,n,i),k.isBuffer(n)&&(i="buffer");var s=t.objectMode?1:n.length;t.length+=s;var a=t.length<t.highWaterMark;return a||(t.needDrain=!0),t.writing||t.corked?t.buffer.push(new r(n,i,o)):l(e,t,!1,s,n,i,o),a}function l(e,t,n,r,i,o,s){t.writelen=r,t.writecb=s,t.writing=!0,t.sync=!0,n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function f(e,t,n,r,i){n?process.nextTick(function(){t.pendingcb--,i(r)}):(t.pendingcb--,i(r)),e._writableState.errorEmitted=!0,e.emit("error",r)}function h(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function p(e,t){var n=e._writableState,r=n.sync,i=n.writecb;if(h(n),t)f(e,n,r,t,i);else{var o=v(e,n);o||n.corked||n.bufferProcessing||!n.buffer.length||y(e,n),r?process.nextTick(function(){d(e,n,o,i)}):d(e,n,o,i)}}function d(e,t,n,r){n||g(e,t),t.pendingcb--,r(),b(e,t)}function g(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function y(e,t){if(t.bufferProcessing=!0,e._writev&&t.buffer.length>1){for(var n=[],r=0;r<t.buffer.length;r++)n.push(t.buffer[r].callback);t.pendingcb++,l(e,t,!0,t.length,t.buffer,"",function(e){for(var r=0;r<n.length;r++)t.pendingcb--,n[r](e)}),t.buffer=[]}else{for(var r=0;r<t.buffer.length;r++){var i=t.buffer[r],o=i.chunk,s=i.encoding,a=i.callback,c=t.objectMode?1:o.length;if(l(e,t,!1,c,o,s,a),t.writing){r++;break}}r<t.buffer.length?t.buffer=t.buffer.slice(r):t.buffer.length=0}t.bufferProcessing=!1}function v(e,t){return t.ending&&0===t.length&&!t.finished&&!t.writing}function m(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function b(e,t){var n=v(e,t);return n&&(0===t.pendingcb?(m(e,t),t.finished=!0,e.emit("finish")):m(e,t)),n}function _(e,t,n){t.ending=!0,b(e,t),n&&(t.finished?process.nextTick(n):e.once("finish",n)),t.ended=!0}e.exports=o;var w=n(10).Buffer;o.WritableState=i;var k=n(5);k.inherits=n(6);var S=n(1);k.inherits(o,S),o.prototype.pipe=function(){this.emit("error",Error("Cannot pipe. Not readable."))},o.prototype.write=function(e,t,n){var r=this._writableState,i=!1;return k.isFunction(t)&&(n=t,t=null),k.isBuffer(e)?t="buffer":t||(t=r.defaultEncoding),k.isFunction(n)||(n=function(){}),r.ended?s(this,r,n):a(this,r,e,n)&&(r.pendingcb++,i=u(this,r,e,t,n)),i},o.prototype.cork=function(){this._writableState.corked++},o.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.buffer.length||y(this,e))},o.prototype._write=function(e,t,n){n(Error("not implemented"))},o.prototype._writev=null,o.prototype.end=function(e,t,n){var r=this._writableState;k.isFunction(e)?(n=e,e=null,t=null):k.isFunction(t)&&(n=t,t=null),k.isNullOrUndefined(e)||this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||_(this,r,n)}},function(e,t,n){function r(e){if(e&&!c(e))throw Error("Unknown encoding: "+e)}function i(e){return e.toString(this.encoding)}function o(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function s(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}var a=n(10).Buffer,c=a.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},u=t.StringDecoder=function(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),r(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=o;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=s;break;default:return void(this.write=i)}this.charBuffer=new a(6),this.charReceived=0,this.charLength=0};u.prototype.write=function(e){for(var t="";this.charLength;){var n=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";e=e.slice(n,e.length),t=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var r=t.charCodeAt(t.length-1);if(!(r>=55296&&r<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var i=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,i),i-=this.charReceived),t+=e.toString(this.encoding,0,i);var i=t.length-1,r=t.charCodeAt(i);if(r>=55296&&r<=56319){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),e.copy(this.charBuffer,0,0,o),t.substring(0,i)}return t},u.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var n=e[e.length-t];if(1==t&&n>>5==6){this.charLength=2;break}if(t<=2&&n>>4==14){this.charLength=3;break}if(t<=3&&n>>3==30){this.charLength=4;break}}this.charReceived=t},u.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var n=this.charReceived,r=this.charBuffer,i=this.encoding;t+=r.slice(0,n).toString(i)}return t}},function(e,t,n){"use strict";function r(){this._t={},this.get=function(e){return this._t[e]},this.set=function(e,t){this._t[e]=t},this.getAll=function(){return this._t}}function i(e,t){try{o.mkdirSync(e,t)}catch(n){i(s.dirname(e),t),i(e,t)}}var o=n(0),s=n(2),a=(n(3),n(11).dataServices),c={};c.getTransient=function(){return console.warn("***********************************************************"),console.warn("*    WARNING: pl_persistent UNAVAILABLE IN THE PLATFORM   *"),console.warn("*   USER DATA WILL BE LOST AFTER GLOBOPLAY PROCESS ENDS!  *"),console.warn("***********************************************************"),c._transient||(c._transient=new r),c._transient};var u=function(e){return this._t||(this._t=[]),e in this._t||(this._t[e]=this._original_get(e)),this._t[e]},l=function(e,t){this._t||(this._t=[]),this._t[e]=t,this._original_set(e,t)};c.getPersistent=function(){if(c._impl)return c._impl;var e="/data/astronav/appdata/globoplay";o.existsSync(e)||i(e);var t=a.getPersistent(e+"/persistent_properties.db");return t?(t._original_get=t.get,t.get=u.bind(t),t._original_set=t.set,t.set=l.bind(t)):t=c.getTransient(),c._impl=t,t},e.exports=c},function(e,t,n){var r=n(0),i=n(2),o=n(3),s={};s.deleteFolderRecursive=function(e){console.log("deleteFolderRecursive - dir:",e),r.existsSync(e)?(r.readdirSync(e).forEach(function(t,n){var i=e+"/"+t;r.lstatSync(i).isDirectory()?s.deleteFolderRecursive(i):r.unlinkSync(i)}),r.rmdirSync(e)):console.log("deleteFolderRecursive - dir does not exist")},s.replaceVersion=function(e,t,s){console.log("replaceVersion - from:",e,",to:",t,",app:",s);var a=n(54),c=function(e){try{r.mkdirSync("/"+e)}catch(e){if("EEXIST"!==e.code)throw e}},u=e+"/"+s,l=t+"/"+s,f=l+"_bck";r.existsSync(e)&&r.existsSync(u)&&(!function(e){for(var t=e.split(i.sep),n=1;n<=t.length;n++)c(i.join.apply(null,t.slice(0,n)))}(t),r.existsSync(l)&&(r.existsSync(f)&&this.deleteFolderRecursive(f),r.renameSync(l,f)),r.renameSync(u,l),a("/tmp/astronav/app_only.json",l+"/versiondata.json"),r.unlinkSync("/tmp/astronav/app_only.json"),r.closeSync(r.openSync(l+"/.complete","w")),o.getProperty("traits.fs.sync_after_self_update")&&n(61).execSync("sync"),this.deleteFolderRecursive(f),this.deleteFolderRecursive(e))},e.exports=s},function(e,t){e.exports=require("constants")},function(e,t){e.exports=require("crypto")},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("https")},function(e,t){e.exports=require("url")},function(e,t,n){function r(e){console.log("[UpdateInstaller.js] "+e)}function i(){this._events={},this.on=function(e,t){this._events[e]=t},this.dispatchEvent=function(e,t){this._events[e]&&this._events[e](t)}}function o(e){return e.toLowerCase().replace(/"/g,"")}function s(e,t,n,s){this._mode=e,this._installedVersion=void 0,this._res=void 0,this._pathTo=void 0,this._destination_dir=void 0,this._checkFileIndex=-1,this._dispatcher=new i,this.start=function(){return r("ModeInstaller:start"),this._try=1,this._installedVersion=c.getInstalledVersion(this._mode),r("installed version = "+this._installedVersion),this._installedVersion?c.getPackageVersion(this._mode,this._getPackageVersionCallback.bind(this)):(this._notify("error","Não foi possível obter número de versão instalada"),this._notify("finish",!1)),this},this.on=function(e,t){return this._dispatcher.on(e,t),this},this._notify=function(e,t){this._dispatcher.dispatchEvent(e,t)},this._replaceFiles=function(){c.replaceVersion(this._mode,this._destination_dir,this._res.appname,this._notify.bind(this,"finish",!0))},this._checkFilesIntegrityCallback=function(e){r("_checkFilesIntegrityCallback(ok = "+e+")"),e?this._checkFilesIntegrity():(this._notify("error","Arquivo "+this._res.postInstallChecksum[this._checkFileIndex]+" corrompido!"),this._notify("finish",!1))},this._checkFilesIntegrity=function(){if(r("this._checkFilesIntegrity - this._checkFileIndex = "+this._checkFileIndex),this._res.postInstallChecksum)if(this._checkFileIndex++,r("Checking if there are new files to check: "+this._checkFileIndex<this._res.postInstallChecksum.length),this._checkFileIndex<this._res.postInstallChecksum.length){var e=this._res.postInstallChecksum[this._checkFileIndex];r("File Info: "+JSON.stringify(e)),r("Checking file integrity: "+this._destination_dir+"/"+e.file),c.checkPackageIntegrity(this._destination_dir+"/"+e.file,e.checksum,this._checkFilesIntegrityCallback.bind(this))}else this._replaceFiles();else this._replaceFiles()},this._extractPackageCallback=function(e,t){if(r("this._extractPackageCallback (evt = "+e+", progress = "+t+")"),"progress"==e&&t){var n=(t.loaded/t.total*100).toFixed(2);this._notify("installProgress",n)}"end"==e&&this._checkFilesIntegrity(),"error"==e&&(this._notify("error","Erro ao extrair o pacote de atualização"),this._notify("finish",!1))},this._checkPackageIntegrityCallback=function(e){r("this._checkPackageIntegrityCallback (ok = "+e+")"),e?(this._destination_dir="//data/astronav//"+this._mode,c.extractPackage(this._mode,this._pathTo,this._destination_dir,this._extractPackageCallback.bind(this))):(this._notify("error","Pacote de atualização corrompido"),this._notify("finish",!1))},this._downloadPackageCallback=function(e,t){if(r("this._downloadPackageCallback (evt = "+e+", progress = "+t+")"),"progress"==e&&t){var n=(t.loaded/t.total*100).toFixed(2);this._notify("downloadProgress",n)}else"end"==e?c.checkPackageIntegrity(this._pathTo,this._res.checksum,this._checkPackageIntegrityCallback.bind(this)):(this._notify("error","Erro no download do globoplay.zip"),this._notify("finish",!1))},this._getPackageVersionCallback=function(e,i){if(r("this._getPackageVersionCallback (err = "+e+", res = "+i+")"),!e&&i){this._res=i,r("res: "+JSON.stringify(this._res)),r("Checking package target platform");var a=o(i.manufacturer)==o(this._installedVersion.manufacturer),u=o(i.model)==o(this._installedVersion.model);if(!a||!u)return r("Target platform ("+i.manufacturer+" "+i.model+") is not valid for current platform ("+i.manufacturer+" "+this._installedVersion.model+")"),this._notify("error","Versão inválida para esta plataforma."),void this._notify("finish",!1);r("Checking new package timestamp"),r("this._installedVersion.timestamp: "+this._installedVersion.timestamp),r("this._res.timestamp: "+this._res.timestamp),s||this._res.timestamp>this._installedVersion.timestamp?(this._pathTo="/tmp/astronav/"+this._res.filename,c.downloadPackage(this._res.url,this._pathTo,this._downloadPackageCallback.bind(this))):(this._notify("error","A versão instalada é a mais atual."),this._notify("finish",!1))}else r("Got an error - should I retry?"),r("this._try = "+this._try),r("_numRetries = "+t),r("_retryDelay = "+n),-1==t||this._try<t?(this._try++,setTimeout(function(){c.getPackageVersion(this._mode,this._getPackageVersionCallback.bind(this))}.bind(this),1e3*n)):(this._notify("error","Erro no download do versiondata.json"),this._notify("finish",!1))}}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._modes=[],this._modes=["app_only"],this._currentMode=-1;var t=e.numRetries,n=void 0===t?l:t,i=e.retryDelay,o=void 0===i?u:i,a=e.skipTimestamp,c=void 0!==a&&a;this.startUpdate=function(e){var t=this;if(++this._currentMode<this._modes.length){new s(this._modes[this._currentMode],n,o,c).on("installProgress",function(t){r("Installing "+t+"%"),e&&e("install_progress",t)}).on("downloadProgress",function(t){r("Downloading "+t+"%"),e&&e("download_progress",t)}).on("error",function(t){e&&e("error",t)}).on("finish",function(n){e&&e(n?"finish":"abort"),t.startUpdate(e)}).start()}else this._onEndCallback&&this._onEndCallback()},this.onEnd=function(e){return this._onEndCallback=e,this}}var c=(n(12).get("globoplay:updateInstaller"),n(3),n(51)),u=10,l=0;e.exports=a},function(e,t,n){function r(e){}function i(){var e="versiondata.json",t=a.getReadOnlyDir()+"/"+e,n=a.getReadWriteDir()+"/"+e;r("RO PATH: "+t),r("RW PATH: "+n);var i=function(e){try{return JSON.parse(s.readFileSync(e,"utf8"))}catch(t){return void r("could not load file "+e)}},o=i(t),c=i(n);if(r("RO DATA: "+JSON.stringify(o)),r("RW DATA: "+JSON.stringify(c)),!(o||(r("WARNING!! RO PATH possibly configured wrong in bundle"),t=a.getFallbackDir()+"/"+e,o=i(t))))throw"Cannot find globoplay app on RO filesystem!";return!!c&&c.timestamp>o.timestamp}function o(){this.startUpdateModule=function(){r("start update module"),(new c).onEnd(this._startApp.bind(this)).startUpdate()},this._tryChDirAndRun=function(e){try{process.chdir(e)}catch(t){return r("chdir to "+e+" failed"),!1}if(r("chdir to "+e+" successful"),!s.existsSync(e+"/bundle.js"))return r("failed: "+e+"/bundle.js does not exist!"),!1;try{require(e+"/bundle.js")}catch(t){return r("require for "+e+"/bundle.js failed (corrupted?)"),!1}return!0},this._startApp=function(e){r("starting the app");var t=a.getReadWriteDir(),n=a.getReadOnlyDir(),o=a.getFallbackDir();r("readWriteDir = "+t),r("readOnlyDir = "+n),r("fallbackDir = "+o);var c=i();r("IS RW NEWER? "+c),c&&s.existsSync(t)&&s.existsSync(t+".complete")&&(r("trying to run bundle from "+t),this._tryChDirAndRun(t))||(r("trying to run bundle from "+n),this._tryChDirAndRun(n)||(r("trying to run bundle from "+o),this._tryChDirAndRun(o)))}}var s=(n(12).get("globoplay"),n(0)),a=n(3),c=n(27);(new o).startUpdateModule()},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){function r(e){for(var t=0,n=0;n<e.length;n++)t+=Math.pow(256,n)*e[n];return t}function i(e){for(var t=0,n=0;n<e.length;n++)t+=Math.pow(256,e.length-n-1)*e[n];return t}function o(e){var t=i(e);return 128==(128&e[0])&&(t-=Math.pow(256,e.length)),t}function s(e){var t=r(e);return 128==(128&e[e.length-1])&&(t-=Math.pow(256,e.length)),t}function a(e){var t={};return[1,2,4,8].forEach(function(n){var a=8*n;t["word"+a+"le"]=t["word"+a+"lu"]=e(n,r),t["word"+a+"ls"]=e(n,s),t["word"+a+"be"]=t["word"+a+"bu"]=e(n,i),t["word"+a+"bs"]=e(n,o)}),t.word8=t.word8u=t.word8be,t.word8s=t.word8bs,t}var c=n(33),u=n(7).EventEmitter,l=n(32),f=n(31),h=n(1).Stream;t=e.exports=function(e,n){if(Buffer.isBuffer(e))return t.parse(e);var r=t.stream();return e&&e.pipe?e.pipe(r):e&&(e.on(n||"data",function(e){r.write(e)}),e.on("end",function(){r.end()})),r},t.stream=function(e){function n(e,t,n){o={bytes:e,skip:n,cb:function(e){o=null,t(e)}},r()}function r(){if(!o)return void(v&&(y=!0));if("function"==typeof o)o();else{var e=s+o.bytes;if(d.length>=e){var t;null==s?(t=d.splice(0,e),o.skip||(t=t.slice())):(o.skip||(t=d.slice(s,e)),s=e),o.skip?o.cb():o.cb(t)}}}function i(e){function t(){y||e.next()}var i=a(function(e,r){return function(i){n(e,function(e){g.set(i,r(e)),t()})}});return i.tap=function(t){e.nest(t,g.store)},i.into=function(t,n){g.get(t)||g.set(t,{});var r=g;g=f(r.get(t)),e.nest(function(){n.apply(this,arguments),this.tap(function(){g=r})},g.store)},i.flush=function(){g.store={},t()},i.loop=function(n){var r=!1;e.nest(!1,function i(){this.vars=g.store,n.call(this,function(){r=!0,t()},g.store),this.tap(function(){r?e.next():i.call(this)}.bind(this))},g.store)},i.buffer=function(e,r){"string"==typeof r&&(r=g.get(r)),n(r,function(n){g.set(e,n),t()})},i.skip=function(e){"string"==typeof e&&(e=g.get(e)),n(e,function(){t()})},i.scan=function(e,n){if("string"==typeof n)n=new Buffer(n);else if(!Buffer.isBuffer(n))throw Error("search must be a Buffer or a string");var i=0;o=function(){var a=d.indexOf(n,s+i),c=a-s-i;-1!==a?(o=null,null!=s?(g.set(e,d.slice(s,s+i+c)),s+=i+c+n.length):(g.set(e,d.slice(0,i+c)),d.splice(0,i+c+n.length)),t(),r()):c=Math.max(d.length-n.length-s-i,0),i+=c},r()},i.peek=function(t){s=0,e.nest(function(){t.call(this,g.store),this.tap(function(){s=null})})},i}if(e)return t.apply(null,arguments);var o=null,s=null,p=c.light(i);p.writable=!0;var d=l();p.write=function(e){d.push(e),r()};var g=f(),y=!1,v=!1;return p.end=function(){v=!0},p.pipe=h.prototype.pipe,Object.getOwnPropertyNames(u.prototype).forEach(function(e){p[e]=u.prototype[e]}),p},t.parse=function(e){var t=a(function(i,o){return function(s){if(n+i<=e.length){var a=e.slice(n,n+i);n+=i,r.set(s,o(a))}else r.set(s,null);return t}}),n=0,r=f();return t.vars=r.store,t.tap=function(e){return e.call(t,r.store),t},t.into=function(e,n){r.get(e)||r.set(e,{});var i=r;return r=f(i.get(e)),n.call(t,r.store),r=i,t},t.loop=function(e){for(var n=!1,i=function(){n=!0};!1===n;)e.call(t,i,r.store);return t},t.buffer=function(i,o){"string"==typeof o&&(o=r.get(o));var s=e.slice(n,Math.min(e.length,n+o));return n+=o,r.set(i,s),t},t.skip=function(e){return"string"==typeof e&&(e=r.get(e)),n+=e,t},t.scan=function(i,o){if("string"==typeof o)o=new Buffer(o);else if(!Buffer.isBuffer(o))throw Error("search must be a Buffer or a string");r.set(i,null);for(var s=0;s+n<=e.length-o.length+1;s++){for(var a=0;a<o.length&&e[n+s+a]===o[a];a++);if(a===o.length)break}return r.set(i,e.slice(n,n+s)),n+=s+o.length,t},t.peek=function(e){var i=n;return e.call(t,r.store),n=i,t},t.flush=function(){return r.store={},t},t.eof=function(){return n>=e.length},t}},function(e,t){e.exports=function(e){function t(e,t){var r=n.store,i=e.split(".");i.slice(0,-1).forEach(function(e){void 0===r[e]&&(r[e]={}),r=r[e]});var o=i[i.length-1];return 1==arguments.length?r[o]:r[o]=t}var n={get:function(e){return t(e)},set:function(e,n){return t(e,n)},store:e||{}};return n}},function(e,t){function n(e){if(!(this instanceof n))return new n(e);this.buffers=e||[],this.length=this.buffers.reduce(function(e,t){return e+t.length},0)}e.exports=n,n.prototype.push=function(){for(var e=0;e<arguments.length;e++)if(!Buffer.isBuffer(arguments[e]))throw new TypeError("Tried to push a non-buffer");for(var e=0;e<arguments.length;e++){var t=arguments[e];this.buffers.push(t),this.length+=t.length}return this.length},n.prototype.unshift=function(){for(var e=0;e<arguments.length;e++)if(!Buffer.isBuffer(arguments[e]))throw new TypeError("Tried to unshift a non-buffer");for(var e=0;e<arguments.length;e++){var t=arguments[e];this.buffers.unshift(t),this.length+=t.length}return this.length},n.prototype.copy=function(e,t,n,r){return this.slice(n,r).copy(e,t,0,r-n)},n.prototype.splice=function(e,t){var r=this.buffers,i=e>=0?e:this.length-e,o=[].slice.call(arguments,2);void 0===t?t=this.length-i:t>this.length-i&&(t=this.length-i);for(var e=0;e<o.length;e++)this.length+=o[e].length;for(var s=new n,a=0,c=0;c<r.length&&a+r[c].length<i;c++)a+=r[c].length;if(i-a>0){var u=i-a;if(u+t<r[c].length){s.push(r[c].slice(u,u+t));for(var l=r[c],f=new Buffer(u),e=0;e<u;e++)f[e]=l[e];for(var h=new Buffer(l.length-u-t),e=u+t;e<l.length;e++)h[e-t-u]=l[e];if(o.length>0){var p=o.slice();p.unshift(f),p.push(h),r.splice.apply(r,[c,1].concat(p)),c+=p.length,o=[]}else r.splice(c,1,f,h),c+=2}else s.push(r[c].slice(u)),r[c]=r[c].slice(0,u),c++}for(o.length>0&&(r.splice.apply(r,[c,0].concat(o)),c+=o.length);s.length<t;){var d=r[c],g=d.length,y=Math.min(g,t-s.length);y===g?(s.push(d),r.splice(c,1)):(s.push(d.slice(0,y)),r[c]=r[c].slice(y))}return this.length-=s.length,s},n.prototype.slice=function(e,t){var n=this.buffers;void 0===t&&(t=this.length),void 0===e&&(e=0),t>this.length&&(t=this.length);for(var r=0,i=0;i<n.length&&r+n[i].length<=e;i++)r+=n[i].length;for(var o=new Buffer(t-e),s=0,a=i;s<t-e&&a<n.length;a++){var c=n[a].length,u=0===s?e-r:0,l=s+c>=t-e?Math.min(u+(t-e)-s,c):c;n[a].copy(o,s,u,l),s+=l-u}return o},n.prototype.pos=function(e){if(e<0||e>=this.length)throw Error("oob");for(var t=e,n=0,r=null;;){if(r=this.buffers[n],t<r.length)return{buf:n,offset:t};t-=r.length,n++}},n.prototype.get=function(e){var t=this.pos(e);return this.buffers[t.buf].get(t.offset)},n.prototype.set=function(e,t){var n=this.pos(e);return this.buffers[n.buf].set(n.offset,t)},n.prototype.indexOf=function(e,t){if("string"==typeof e)e=new Buffer(e);else if(!(e instanceof Buffer))throw Error("Invalid type for a search string");if(!e.length)return 0;if(!this.length)return-1;var n,r=0,i=0,o=0,s=0;if(t){var a=this.pos(t);r=a.buf,i=a.offset,s=t}for(;;){for(;i>=this.buffers[r].length;)if(i=0,++r>=this.buffers.length)return-1;if(this.buffers[r][i]==e[o]){if(0==o&&(n={i:r,j:i,pos:s}),++o==e.length)return n.pos}else 0!=o&&(r=n.i,i=n.j,s=n.pos,o=0);i++,s++}},n.prototype.toBuffer=function(){return this.slice()},n.prototype.toString=function(e,t,n){return this.slice(t,n).toString(e)}},function(e,t,n){function r(e){var t=r.saw(e,{}),n=e.call(t.handlers,t);return void 0!==n&&(t.handlers=n),t.record(),t.chain()}function i(e){e.step=0,e.pop=function(){return e.actions[e.step++]},e.trap=function(t,n){var r=Array.isArray(t)?t:[t];e.actions.push({path:r,step:e.step,cb:n,trap:!0})},e.down=function(t){var n=(Array.isArray(t)?t:[t]).join("/"),r=e.actions.slice(e.step).map(function(t){return!(t.trap&&t.step<=e.step)&&t.path.join("/")==n}).indexOf(!0);r>=0?e.step+=r:e.step=e.actions.length;var i=e.actions[e.step-1];i&&i.trap?(e.step=i.step,i.cb()):e.next()},e.jump=function(t){e.step=t,e.next()}}var o=n(47),s=n(7).EventEmitter;e.exports=r,r.light=function(e){var t=r.saw(e,{}),n=e.call(t.handlers,t);return void 0!==n&&(t.handlers=n),t.chain()},r.saw=function(e,t){var n=new s;return n.handlers=t,n.actions=[],n.chain=function(){var e=o(n.handlers).map(function(t){if(this.isRoot)return t;var r=this.path;"function"==typeof t&&this.update(function(){return n.actions.push({path:r,args:[].slice.call(arguments)}),e})});return process.nextTick(function(){n.emit("begin"),n.next()}),e},n.pop=function(){return n.actions.shift()},n.next=function(){var e=n.pop();if(e){if(!e.trap){var t=n.handlers;e.path.forEach(function(e){t=t[e]}),t.apply(n.handlers,e.args)}}else n.emit("end")},n.nest=function(t){var i=[].slice.call(arguments,1),o=!0;if("boolean"==typeof t){var o=t;t=i.shift()}var s=r.saw(e,{}),a=e.call(s.handlers,s);void 0!==a&&(s.handlers=a),void 0!==n.step&&s.record(),t.apply(s.chain(),i),!1!==o&&s.on("end",n.next)},n.record=function(){i(n)},["trap","down","jump"].forEach(function(e){n[e]=function(){throw Error("To use the trap, down and jump features, please call record() first to start recording actions.")}}),n}},function(e,t,n){"use strict";function r(e){c.EventEmitter.call(this),this.filename=e,this.stats=null,this.fd=null,this.chunkSize=1048576,this.dirCache={},this._p={}}var i=n(14),o=n(15),s=n(2),a=n(8),c=n(7),u=n(38),l=n(37),f=n(35),h=n(36),p=o.denodeify(i.fstat),d=o.denodeify(i.read),g=o.denodeify(i.open);a.inherits(r,c.EventEmitter),r.prototype.openFile=function(){return g(this.filename,"r")},r.prototype.closeFile=function(){this.fd&&(i.closeSync(this.fd),this.fd=null)},r.prototype.statFile=function(e){return this.fd=e,p(e)},r.prototype.list=function(){var e=this;return this.getFiles().then(function(t){var n=[];t.forEach(function(e){n.push(e.path)}),e.emit("list",n)}).fail(function(t){e.emit("error",t)}).fin(e.closeFile.bind(e)),this},r.prototype.extract=function(e){var t=this;return e=e||{},e.path=e.path||".",e.filter=e.filter||null,e.follow=!!e.follow,e.strip=+e.strip||0,this.getFiles().then(function(n){var r=[];return e.filter&&(n=n.filter(e.filter)),e.follow&&(r=n.filter(function(e){return"SymbolicLink"===e.type}),n=n.filter(function(e){return"SymbolicLink"!==e.type})),e.strip&&(n=n.map(function(t){if("Directory"!==t.type){var n=t.parent.split("/"),r=t.filename;if(e.strip>n.length)throw Error("You cannot strip more levels than there are directories");return n=n.slice(e.strip),t.path=s.join(n.join(s.sep),r),t}})),t.extractFiles(n,e).then(t.extractFiles.bind(t,r,e))}).then(function(e){t.emit("extract",e)}).fail(function(e){t.emit("error",e)}).fin(t.closeFile.bind(t)),this},r.prototype.getSearchBuffer=function(e){var t=Math.min(e.size,this.chunkSize);return this.stats=e,this.getBuffer(e.size-t,e.size)},r.prototype.getBuffer=function(e,t){var n=t-e;return d(this.fd,new Buffer(n),0,n,e).then(function(e){return e[1]})},r.prototype.findEndOfDirectory=function(e){for(var t=e.length-3,n="";t>Math.max(e.length-this.chunkSize,0)&&n!==l.END_OF_CENTRAL_DIRECTORY;)t--,n=e.readUInt32LE(t);if(n!==l.END_OF_CENTRAL_DIRECTORY)throw Error("Could not find the End of Central Directory Record");return e.slice(t)},r.prototype.readDirectory=function(e){var t=u.readEndRecord(e);return this.getBuffer(t.directoryOffset,t.directoryOffset+t.directorySize).then(u.readDirectory.bind(null))},r.prototype.getFiles=function(){return this._p.getFiles||(this._p.getFiles=this.openFile().then(this.statFile.bind(this)).then(this.getSearchBuffer.bind(this)).then(this.findEndOfDirectory.bind(this)).then(this.readDirectory.bind(this)).then(this.readFileEntries.bind(this))),this._p.getFiles},r.prototype.readFileEntries=function(e){var t=[],n=[],r=this;return e.forEach(function(i,o){var s=i.relativeOffsetOfLocalHeader,a=Math.min(r.stats.size,s+u.maxFileEntrySize),c=new h(i),l=r.getBuffer(s,a).then(u.readFileEntry.bind(null)).then(function(t){var i;c.compressedSize>0?i=c.compressedSize:(i=r.stats.size,o<e.length-1&&(i=e[o+1].relativeOffsetOfLocalHeader),i-=s+t.entryLength),c._offset=s+t.entryLength,c._maxSize=i,r.emit("file",c),n[o]=c});t.push(l)}),o.all(t).then(function(){return n})},r.prototype.extractFiles=function(e,t,n){var r=[],i=this;n=n||[];var s=0;return e.forEach(function(o){var a=i.extractFile(o,t).then(function(t){i.emit("progress",s++,e.length),n.push(t)});r.push(a)}),o.all(r).then(function(){return n})},r.prototype.extractFile=function(e,t){var n=s.join(t.path,e.path);if("Directory"===e.type)return f.folder(e,n,this);if("File"===e.type)switch(e.compressionMethod){case 0:return f.store(e,n,this);case 8:return f.deflate(e,n,this);default:throw Error("Unsupported compression type")}if("SymbolicLink"===e.type)return t.follow?f.copy(e,n,this,t.path):f.symlink(e,n,this,t.path);throw Error('Unsupported file type "'+e.type+'"')},e.exports=r},function(e,t,n){var r=n(1);if(!r.Readable)var r=n(45);var i=n(14),o=n(15),s=n(2),a=n(64),c=o.denodeify(n(46)),u=o.denodeify(n(43)),l=o.denodeify(i.writeFile),f=o.denodeify(a.inflateRaw),h=o.denodeify(i.symlink),p=o.denodeify(i.stat),d=function e(t,n,r){if(t=s.normalize(s.resolve(process.cwd(),t)+s.sep),void 0===r&&(r=parseInt("777",8)&~process.umask()),!n[t]){var a;a=i.existsSync(t)?new o:e(s.dirname(t),n,r),n[t]=a.then(function(){return u(t,r)})}return n[t]},g={folder:function(e,t,n){return d(t,n.dirCache,e.mode).then(function(){return{folder:e.path}})},store:function(e,t,n){var o;if(0===e.uncompressedSize)o=c.bind(null,t);else if(e.uncompressedSize<=n.chunkSize)o=function(){return n.getBuffer(e._offset,e._offset+e.uncompressedSize).then(function(n){return l(t,n,{mode:e.mode})})};else{var a=new r.Readable;a.wrap(i.createReadStream(n.filename,{start:e._offset,end:e._offset+e.uncompressedSize-1})),o=v.bind(null,a,t,{mode:e.mode})}return d(s.dirname(t),n.dirCache).then(o).then(function(){return{stored:e.path}})},deflate:function(e,t,n){return d(s.dirname(t),n.dirCache).then(function(){if(e._maxSize<=n.chunkSize)return n.getBuffer(e._offset,e._offset+e._maxSize).then(f).then(function(n){return l(t,n,{mode:e.mode})});var o=new r.Readable;o.wrap(i.createReadStream(n.filename,{start:e._offset}));var s=o.pipe(a.createInflateRaw({highWaterMark:32768}));return v(s,t,{mode:e.mode})}).then(function(){return{deflated:e.path}})},symlink:function(e,t,n,r){var i=s.dirname(t);return d(i,n.dirCache).then(function(){return y(e,t,n,r)}).then(function(n){return h(s.resolve(i,n),t).then(function(){return{symlink:e.path,linkTo:n}})})},copy:function(e,t,n,o){var a,c=s.dirname(t);return d(c,n.dirCache).then(function(){return y(e,t,n,o)}).then(function(o){return p(s.resolve(c,o)).then(function(e){if(e.isFile()){a="File";var u=new r.Readable;return u.wrap(i.createReadStream(s.resolve(c,o))),v(u,t)}if(e.isDirectory())return a="Directory",d(t,n.dirCache);throw Error("Could not follow symlink to unknown file type")}).then(function(){return{copy:e.path,original:o,type:a}})})}},y=function(e,t,n,r){var i=s.dirname(t);return n.getBuffer(e._offset,e._offset+e.uncompressedSize).then(function(e){var t=""+e,n=s.resolve(i,t);if(".."===s.relative(r,n).slice(0,2))throw Error("Symlink links outside archive");return t})},v=function(e,t,n){var r=o.defer(),s=i.createWriteStream(t,n),a=function(e){r.reject(e)};return e.on("error",a),s.on("error",a),e.on("end",function(){s.end(function(){r.resolve()})}),e.pipe(s,{end:!1}),r.promise};e.exports=g},function(e,t,n){var r=n(2),i=function(e){this._offset=0,this._maxSize=0,this.parent=r.dirname(e.fileName),this.filename=r.basename(e.fileName),this.path=r.normalize(e.fileName),this.type=e.fileAttributes.type,this.mode=e.fileAttributes.mode,this.compressionMethod=e.compressionMethod,this.modified=e.modifiedTime,this.crc32=e.crc32,this.compressedSize=e.compressedSize,this.uncompressedSize=e.uncompressedSize,this.comment=e.fileComment,this.flags={encrypted:e.generalPurposeFlags.encrypted,compressionFlag1:e.generalPurposeFlags.compressionFlag1,compressionFlag2:e.generalPurposeFlags.compressionFlag2,useDataDescriptor:e.generalPurposeFlags.useDataDescriptor,enhancedDeflating:e.generalPurposeFlags.enhancedDeflating,compressedPatched:e.generalPurposeFlags.compressedPatched,strongEncryption:e.generalPurposeFlags.strongEncryption,utf8:e.generalPurposeFlags.utf8,encryptedCD:e.generalPurposeFlags.encryptedCD}};e.exports=i},function(e,t){e.exports={LOCAL_FILE_HEADER:67324752,DATA_DESCRIPTOR_RECORD:134695760,ARCHIVE_EXTRA_DATA:134630224,CENTRAL_FILE_HEADER:33639248,HEADER:84233040,ZIP64_END_OF_CENTRAL_DIRECTORY:101075792,ZIP64_END_OF_CENTRAL_DIRECTORY_LOCATOR:117853008,END_OF_CENTRAL_DIRECTORY:101010256}},function(e,t,n){"use strict";var r=n(30),i=function(e,t){var n=1980+(e>>9&127),r=e>>5&15,i=31&e,o=t>>11,s=t>>5&63,a=2*(31&t);return new Date(n,r-1,i,o,s,a,0)},o=function(e){for(var t=[],n=0;n<16;n++)t[n]=e>>n&1;return{encrypted:!!t[0],compressionFlag1:!!t[1],compressionFlag2:!!t[2],useDataDescriptor:!!t[3],enhancedDeflating:!!t[4],compressedPatched:!!t[5],strongEncryption:!!t[6],utf8:!!t[11],encryptedCD:!!t[13]}},s=function(e,t){var n={1:"NamedPipe",2:"Character",4:"Directory",6:"Block",8:"File",10:"SymbolicLink",12:"Socket"};switch(t){case 3:return{platform:"Unix",type:n[e>>28&15],mode:e>>16&4095};default:0!==t&&console.warn("Possibly unsupported ZIP platform type, "+t);var r={A:e>>5&1,D:e>>4&1,V:e>>3&1,S:e>>2&1,H:e>>1&1,R:1&e},i=parseInt("0444",8);return r.D&&(i|=parseInt("0111",8)),r.R||(i|=parseInt("0222",8)),i&=~process.umask(),{platform:"DOS",type:r.D?"Directory":"File",mode:i}}},a=function(e){var t=r.parse(e).word32lu("signature").word16lu("diskNumber").word16lu("directoryStartDisk").word16lu("directoryEntryCountDisk").word16lu("directoryEntryCount").word32lu("directorySize").word32lu("directoryOffset").word16lu("commentLength").buffer("comment","commentLength").vars;return t.comment=""+t.comment,t},c=function(e,t){return e.relativeOffsetOfLocalHeader-t.relativeOffsetOfLocalHeader},u=function(e){for(var t,n=[],a=0;a<e.length;)t=r.parse(e.slice(a,a+46)).word32lu("signature").word8lu("creatorSpecVersion").word8lu("creatorPlatform").word8lu("requiredSpecVersion").word8lu("requiredPlatform").word16lu("generalPurposeBitFlag").word16lu("compressionMethod").word16lu("lastModFileTime").word16lu("lastModFileDate").word32lu("crc32").word32lu("compressedSize").word32lu("uncompressedSize").word16lu("fileNameLength").word16lu("extraFieldLength").word16lu("fileCommentLength").word16lu("diskNumberStart").word16lu("internalFileAttributes").word32lu("externalFileAttributes").word32lu("relativeOffsetOfLocalHeader").vars,a+=46,t.generalPurposeFlags=o(t.generalPurposeBitFlag),t.fileAttributes=s(t.externalFileAttributes,t.creatorPlatform),t.modifiedTime=i(t.lastModFileDate,t.lastModFileTime),t.fileName=t.extraField=t.fileComment="",t.headerLength=46+t.fileNameLength+t.extraFieldLength+t.fileCommentLength,t.fileNameLength>0&&(t.fileName=""+e.slice(a,a+t.fileNameLength),a+=t.fileNameLength),t.extraFieldLength>0&&(t.extraField=""+e.slice(a,a+t.extraFieldLength),a+=t.extraFieldLength),t.fileCommentLength>0&&(t.fileComment=""+e.slice(a,a+t.fileCommentLength),a+=t.fileCommentLength),"Directory"!==t.fileAttributes.type&&"/"===t.fileName.substr(-1)&&(t.fileAttributes.type="Directory"),n.push(t);return n.sort(c),n},l=function(e){var t=0,n=r.parse(e.slice(t,30)).word32lu("signature").word16lu("versionNeededToExtract").word16lu("generalPurposeBitFlag").word16lu("compressionMethod").word16lu("lastModFileTime").word16lu("lastModFileDate").word32lu("crc32").word32lu("compressedSize").word32lu("uncompressedSize").word16lu("fileNameLength").word16lu("extraFieldLength").vars;if(t+=30,n.fileName=n.extraField="",n.entryLength=30+n.fileNameLength+n.extraFieldLength,n.entryLength>f.maxFileEntrySize)throw Error("File entry unexpectedly large: "+n.entryLength+" (max: "+f.maxFileEntrySize+")");return n.fileNameLength>0&&(n.fileName=""+e.slice(t,t+n.fileNameLength),t+=n.fileNameLength),n.extraFieldLength>0&&(n.extraField=""+e.slice(t,t+n.extraFieldLength),t+=n.extraFieldLength),n},f=e.exports={readEndRecord:a,readDirectory:u,readFileEntry:l,maxFileEntrySize:4096}},function(e,t,n){function r(e){function t(n,r){if(!(this instanceof t))return new t(n,r);i.call(this);var o=this;this.path=n,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=65536,r=r||{};for(var s=Object.keys(r),a=0,c=s.length;a<c;a++){var u=s[a];this[u]=r[u]}if(this.encoding&&this.setEncoding(this.encoding),void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(void 0===this.end)this.end=1/0;else if("number"!=typeof this.end)throw TypeError("end must be a Number");if(this.start>this.end)throw Error("start must be <= end");this.pos=this.start}if(null!==this.fd)return void process.nextTick(function(){o._read()});e.open(this.path,this.flags,this.mode,function(e,t){if(e)return o.emit("error",e),void(o.readable=!1);o.fd=t,o.emit("open",t),o._read()})}function n(t,r){if(!(this instanceof n))return new n(t,r);i.call(this),this.path=t,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,r=r||{};for(var o=Object.keys(r),s=0,a=o.length;s<a;s++){var c=o[s];this[c]=r[c]}if(void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(this.start<0)throw Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],null===this.fd&&(this._open=e.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}return{ReadStream:t,WriteStream:n}}var i=n(1).Stream;e.exports=r},function(e,t,n){function r(e){d.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&i(e),e.lutimes||o(e),e.chown=c(e.chown),e.fchown=c(e.fchown),e.lchown=c(e.lchown),e.chmod=s(e.chmod),e.fchmod=s(e.fchmod),e.lchmod=s(e.lchmod),e.chownSync=u(e.chownSync),e.fchownSync=u(e.fchownSync),e.lchownSync=u(e.lchownSync),e.chmodSync=a(e.chmodSync),e.fchmodSync=a(e.fchmodSync),e.lchmodSync=a(e.lchmodSync),e.stat=l(e.stat),e.fstat=l(e.fstat),e.lstat=l(e.lstat),e.statSync=f(e.statSync),e.fstatSync=f(e.fstatSync),e.lstatSync=f(e.lstatSync),e.lchmod||(e.lchmod=function(e,t,n){n&&process.nextTick(n)},e.lchmodSync=function(){}),e.lchown||(e.lchown=function(e,t,n,r){r&&process.nextTick(r)},e.lchownSync=function(){}),"win32"===v&&(e.rename=function(t){return function(n,r,i){var o=Date.now(),s=0;t(n,r,function a(c){if(c&&("EACCES"===c.code||"EPERM"===c.code)&&Date.now()-o<6e4)return setTimeout(function(){e.stat(r,function(e,o){e&&"ENOENT"===e.code?t(n,r,a):i(c)})},s),void(s<100&&(s+=10));i&&i(c)})}}(e.rename)),e.read=function(t){return function(n,r,i,o,s,a){var c;if(a&&"function"==typeof a){var u=0;c=function(l,f,h){if(l&&"EAGAIN"===l.code&&u<10)return u++,t.call(e,n,r,i,o,s,c);a.apply(this,arguments)}}return t.call(e,n,r,i,o,s,c)}}(e.read),e.readSync=function(t){return function(n,r,i,o,s){for(var a=0;;)try{return t.call(e,n,r,i,o,s)}catch(e){if("EAGAIN"===e.code&&a<10){a++;continue}throw e}}}(e.readSync)}function i(e){e.lchmod=function(t,n,r){e.open(t,d.O_WRONLY|d.O_SYMLINK,n,function(t,i){if(t)return void(r&&r(t));e.fchmod(i,n,function(t){e.close(i,function(e){r&&r(t||e)})})})},e.lchmodSync=function(t,n){var r,i=e.openSync(t,d.O_WRONLY|d.O_SYMLINK,n),o=!0;try{r=e.fchmodSync(i,n),o=!1}finally{if(o)try{e.closeSync(i)}catch(e){}else e.closeSync(i)}return r}}function o(e){d.hasOwnProperty("O_SYMLINK")?(e.lutimes=function(t,n,r,i){e.open(t,d.O_SYMLINK,function(t,o){if(t)return void(i&&i(t));e.futimes(o,n,r,function(t){e.close(o,function(e){i&&i(t||e)})})})},e.lutimesSync=function(t,n,r){var i,o=e.openSync(t,d.O_SYMLINK),s=!0;try{i=e.futimesSync(o,n,r),s=!1}finally{if(s)try{e.closeSync(o)}catch(e){}else e.closeSync(o)}return i}):(e.lutimes=function(e,t,n,r){r&&process.nextTick(r)},e.lutimesSync=function(){})}function s(e){return e?function(t,n,r){return e.call(p,t,n,function(e){h(e)&&(e=null),r&&r.apply(this,arguments)})}:e}function a(e){return e?function(t,n){try{return e.call(p,t,n)}catch(e){if(!h(e))throw e}}:e}function c(e){return e?function(t,n,r,i){return e.call(p,t,n,r,function(e){h(e)&&(e=null),i&&i.apply(this,arguments)})}:e}function u(e){return e?function(t,n,r){try{return e.call(p,t,n,r)}catch(e){if(!h(e))throw e}}:e}function l(e){return e?function(t,n){return e.call(p,t,function(e,t){if(!t)return n.apply(this,arguments);t.uid<0&&(t.uid+=4294967296),t.gid<0&&(t.gid+=4294967296),n&&n.apply(this,arguments)})}:e}function f(e){return e?function(t){var n=e.call(p,t);return n.uid<0&&(n.uid+=4294967296),n.gid<0&&(n.gid+=4294967296),n}:e}function h(e){return!e||("ENOSYS"===e.code||!(process.getuid&&0===process.getuid()||"EINVAL"!==e.code&&"EPERM"!==e.code))}var p=n(13),d=n(22),g=process.cwd,y=null,v=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return y||(y=g.call(process)),y};try{process.cwd()}catch(e){}var m=process.chdir;process.chdir=function(e){y=null,m.call(process,e)},e.exports=r},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t){e.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},function(e,t,n){var r=n(0),i=n(2),o=function e(t,n,o){t=i.resolve(t),"function"!=typeof n&&void 0!==n||(o=n,n=511&~process.umask()),o||(o=function(){}),r.stat(t,function(s,a){s?"ENOENT"===s.code?e(i.dirname(t),n,function(e){e?o(e):r.mkdir(t,n,o)}):o(s):o(a.isDirectory()?null:Error(t+" exists and is not a directory"))})};o.sync=function e(t,n){t=i.resolve(t),void 0===n&&(n=511&~process.umask());try{if(!r.statSync(t).isDirectory())throw Error(t+" exists and is not a directory")}catch(o){if("ENOENT"!==o.code)throw o;e(i.dirname(t),n),r.mkdirSync(t,n)}},e.exports=o},function(e,t,n){function r(e){if(!(this instanceof r))return new r(e);i.call(this,e)}e.exports=r;var i=n(17),o=n(5);o.inherits=n(6),o.inherits(r,i),r.prototype._transform=function(e,t,n){n(null,e)}},function(e,t,n){t=e.exports=n(16),t.Stream=n(1),t.Readable=t,t.Writable=n(18),t.Duplex=n(4),t.Transform=n(17),t.PassThrough=n(44),process.browser||"disable"!==process.env.READABLE_STREAM||(e.exports=n(1))},function(e,t,n){function r(e){e=Object.create(e||{});var t=new Date(e.time||Date.now());e.atime||e.mtime?!0===e.atime?e.atime=t:!0===e.mtime&&(e.mtime=t):e.atime=e.mtime=t;var n=0;return e.force||(n|=w.O_RDWR),e.nocreate||(n|=w.O_CREAT),e.oflags=n,e}function i(e,t,n,r){return n.ref?r?_.stat(n.ref,o(e,t,n,r)):o(e,t,n)(null,_.statSync(n.ref)):e(t,n,r)}function o(e,t,n,r){return function(i,o){return i?(i.path=i.file=n.ref,r(i)):(n.atime=n.atime&&o.atime.getTime(),n.mtime=n.mtime&&o.mtime.getTime(),n.ref=null,e(t,n,r))}}function s(e,t,n){return"function"==typeof t&&(n=t,t=null),t=r(t),i(a,e,r(t),n)}function a(e,t,n){return c(e,t,n)}function c(e,t,n){return t.closeAfter=!0,n?_.open(e,t.oflags,u(t,n)):u(t)(null,_.openSync(e,t.oflags))}function u(e,t){return function(n,r){return n?(r&&e.closeAfter&&_.close(r,function(){}),t(n)):l(r,e,t)}}function l(e,t,n){return"function"==typeof t&&(n=t,t=null),i(f,e,r(t),n)}function f(e,t,n){return h(e,t,n)}function h(e,t,n){return t.atime&&t.mtime?d(e,t,n):n?_.fstat(e,p(e,t,n)):p(e,t)(null,_.fstatSync(e))}function p(e,t,n){return function(r,i){return r?(t.closeAfter&&_.close(e,function(){}),n(r)):(t.atime=t.atime||i.atime.getTime(),t.mtime=t.mtime||i.mtime.getTime(),d(e,t,n))}}function d(e,t,n){"object"===b(t.atime)&&(t.atime=t.atime.getTime()),"object"===b(t.mtime)&&(t.mtime=t.mtime.getTime());var r=parseInt(t.atime/1e3,10),i=parseInt(t.mtime/1e3,10);return n?_.futimes(e,r,i,g(e,t,n)):g(e,t)(null,_.futimesSync(e,r,i))}function g(e,t,n){return function(r,i){return r?(t.closeAfter&&_.close(e,function(){}),n(r)):y(e,t,i,n)}}function y(e,t,n,r){return t.closeAfter?v(e,t,n,r):r?r(null,n):n}function v(e,t,n,r){return r?_.close(e,m(n,t,r)):m(n,t)(null,_.closeSync(e))}function m(e,t,n){return function(r){return r?n(r):(t.closeAfter=null,y(null,t,e,n))}}var b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_=n(0),w=n(22);e.exports=s,s.touchSync=s.sync=function(e,t){return s(e,t)},s.ftouch=l,s.ftouchSync=function(e,t){return l(e,t)}},function(e,t){function n(e){if(!(this instanceof n))return new n(e);this.value=e}function r(e,t,n){var r=[],s=[],a=!0;return function e(c){var u=n?i(c):c,l={},f={node:u,node_:c,path:[].concat(r),parent:s.slice(-1)[0],key:r.slice(-1)[0],isRoot:0===r.length,level:r.length,circular:null,update:function(e){f.isRoot||(f.parent.node[f.key]=e),f.node=e},delete:function(){delete f.parent.node[f.key]},remove:function(){Array.isArray(f.parent.node)?f.parent.node.splice(f.key,1):delete f.parent.node[f.key]},before:function(e){l.before=e},after:function(e){l.after=e},pre:function(e){l.pre=e},post:function(e){l.post=e},stop:function(){a=!1}};if(!a)return f;if("object"===(void 0===u?"undefined":o(u))&&null!==u){f.isLeaf=0==Object.keys(u).length;for(var h=0;h<s.length;h++)if(s[h].node_===c){f.circular=s[h];break}}else f.isLeaf=!0;f.notLeaf=!f.isLeaf,f.notRoot=!f.isRoot;var p=t.call(f,f.node);if(void 0!==p&&f.update&&f.update(p),l.before&&l.before.call(f,f.node),"object"==o(f.node)&&null!==f.node&&!f.circular){s.push(f);var d=Object.keys(f.node);d.forEach(function(t,i){r.push(t),l.pre&&l.pre.call(f,f.node[t],t);var o=e(f.node[t]);n&&Object.hasOwnProperty.call(f.node,t)&&(f.node[t]=o.node),o.isLast=i==d.length-1,o.isFirst=0==i,l.post&&l.post.call(f,o),r.pop()}),s.pop()}return l.after&&l.after.call(f,f.node),f}(e).node}function i(e){if("object"===(void 0===e?"undefined":o(e))&&null!==e){var t;return t=Array.isArray(e)?[]:e instanceof Date?new Date(e):e instanceof Boolean?new Boolean(e):e instanceof Number?new Number(e):e instanceof String?new String(e):Object.create(Object.getPrototypeOf(e)),Object.keys(e).forEach(function(n){t[n]=e[n]}),t}return e}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=n,n.prototype.get=function(e){for(var t=this.value,n=0;n<e.length;n++){var r=e[n];if(!Object.hasOwnProperty.call(t,r)){t=void 0;break}t=t[r]}return t},n.prototype.set=function(e,t){for(var n=this.value,r=0;r<e.length-1;r++){var i=e[r];Object.hasOwnProperty.call(n,i)||(n[i]={}),n=n[i]}return n[e[r]]=t,t},n.prototype.map=function(e){return r(this.value,e,!0)},n.prototype.forEach=function(e){return this.value=r(this.value,e,!1),this.value},n.prototype.reduce=function(e,t){var n=1===arguments.length,r=n?this.value:t;return this.forEach(function(t){this.isRoot&&n||(r=e.call(this,r,t))}),r},n.prototype.deepEqual=function(e){if(1!==arguments.length)throw Error("deepEqual requires exactly one object to compare against");var t=!0,r=e;return this.forEach(function(i){var s=function(){t=!1}.bind(this);if(!this.isRoot){if("object"!==(void 0===r?"undefined":o(r)))return s();r=r[this.key]}var a=r;this.post(function(){r=a});var c=function(e){return Object.prototype.toString.call(e)};if(this.circular)n(e).get(this.circular.path)!==a&&s();else if((void 0===a?"undefined":o(a))!==(void 0===i?"undefined":o(i)))s();else if(null===a||null===i||void 0===a||void 0===i)a!==i&&s();else if(a.__proto__!==i.__proto__)s();else if(a===i);else if("function"==typeof a)a instanceof RegExp?""+a!=""+i&&s():a!==i&&s();else if("object"===(void 0===a?"undefined":o(a)))if("[object Arguments]"===c(i)||"[object Arguments]"===c(a))c(a)!==c(i)&&s();else if(a instanceof Date||i instanceof Date)a instanceof Date&&i instanceof Date&&a.getTime()===i.getTime()||s();else{var u=Object.keys(a),l=Object.keys(i);if(u.length!==l.length)return s();for(var f=0;f<u.length;f++){var h=u[f];Object.hasOwnProperty.call(i,h)||s()}}}),t},n.prototype.paths=function(){var e=[];return this.forEach(function(t){e.push(this.path)}),e},n.prototype.nodes=function(){var e=[];return this.forEach(function(t){e.push(this.node)}),e},n.prototype.clone=function(){var e=[],t=[];return function n(r){for(var s=0;s<e.length;s++)if(e[s]===r)return t[s];if("object"===(void 0===r?"undefined":o(r))&&null!==r){var a=i(r);return e.push(r),t.push(a),Object.keys(r).forEach(function(e){a[e]=n(r[e])}),e.pop(),t.pop(),a}return r}(this.value)},Object.keys(n.prototype).forEach(function(e){n[e]=function(t){var r=[].slice.call(arguments,1),i=n(t);return i[e].apply(i,r)}})},function(e,t,n){global.LRUCache||(global.LRUCache=n(56)),function(){"use strict";function t(e){h.info("constructor("+e.sizeLimit+")"),this.LRUCache_constructor(e);var t=function(e){try{r.mkdirSync("/"+e)}catch(e){if("EEXIST"!==e.code)throw e}},n=function(e){for(var n=e.split(c.sep),r=1;r<=n.length;r++)t(c.join.apply(null,n.slice(0,r)))};this.rootPath=e.rootPath||DEF_FILE_CACHE_DIR,h.info("constructor - Directory Configured: "+this.rootPath),r.existsSync(this.rootPath)?(h.debug("constructor - Directory Exists. Remove all Files..."),u.deleteFolderRecursive(this.rootPath),n(this.rootPath),h.debug("constructor - Done!")):(h.debug("constructor - Directory Non-Existent. Create..."),n(this.rootPath),h.debug("constructor - Done!"))}var r=n(0),i=n(24),o=n(25),s=n(1).Transform,a=n(23),c=n(2),u=n(21),l=n(52),f=n(26),h=Logger.get("FileCache");h.setLevel(Logger.OFF);var p=astrojs.extend(t,LRUCache);p._getHashedPath=function(e){h.debug("_getHashedPath - url: "+e);var t=e.lastIndexOf("."),n=null;-1!=t?(n=e.substring(t+1),n.length>4&&(n=n.indexOf("jpg")?"jpg":n.indexOf("jpeg")?"jpeg":n.indexOf("png")?"png":"jpg")):n="jpg";var r=this.rootPath+a.createHash("md5").update(e).digest("hex")+"."+n;return h.debug("_getHashedPath - url: "+e+" - returning hashed path "+r),r},p._downloadFile=function(e,t){h.debug("_downloadFile - key: "+e);var n=decodeURIComponent(e);h.debug("_downloadFile - url: "+n);var a=null;if(0==n.indexOf("http://")?a=i:0==n.indexOf("https://")&&(a=o),a){var c=this._getHashedPath(n);h.debug("_downloadFile - filename: "+c);var u=f.parse(n);u.lookup=l;var p=a.request(u,function(n){var i=new s;n.statusCode>300&&n.statusCode<400&&n.headers.location?this._downloadFile(n.headers.location,t):(n.on("data",function(e){i.push(e)}),n.on("end",function(){r.writeFile(c,i.read(),function(n){if(n)h.warn("_downloadFile - failed to try to save file in the filesystem"),t("[FileCache Error] Fetch failed to save file in filesystem",null,null);else{var i={};i.key=e,i.filename=c,r.stat(c,function(e,n){!e&&n?(i.objsize=n.size,h.debug("_downloadFile - downloaded file "+c+" successfully"),t(null,i,i.objsize)):(h.warn("_downloadFile - failed to try to get fileSize"),t("[FileCache Error] Fetch failed to try get filesize",null,null))})}})}))}.bind(this));p.on("error",function(e){h.warn("_downloadFile - Connection Error:",e),t("[FileCache Error] Connection error: "+e,null,null)}),p.end()}},p.fetch=function(e,t){h.debug("fetch - key: "+e),e?this._downloadFile(e,t):(h.warn("fetch - invalid key"),t("[FileCache Error] Invalid key",null,null))},p.doDelete=function(e){h.debug("doDelete - key: "+e);var t=this.check(e);if(t){var n=t.filename;r.unlink(n,function(t){t?h.warn("doDelete - key: "+e+" - could not delete file "+n):h.debug("doDelete - key: "+e+" - removed file "+n+" successfully")})}else h.debug("doDelete - key: "+e+" - could not find entry for this key")},t=astrojs.promote(t,"LRUCache"),e.exports=t}()},function(e,t,n){"use strict";var r={},i=n(7),o=n(11),s=new i,a={0:"ENTER",1:"BACK",2:"EXIT",3:"CURSOR_UP",4:"CURSOR_DOWN",5:"CURSOR_LEFT",6:"CURSOR_RIGHT",7:"PLAY",8:"PAUSE",9:"STOP",10:"FASTFWD",11:"REWIND",12:"RED",13:"GREEN",14:"YELLOW",15:"BLUE",16:"0",17:"1",18:"2",19:"3",20:"4",21:"5",22:"6",23:"7",24:"8",25:"9"},c=new o.InputWorker(function(e,t){"keypress"!=e&&"keyrelease"!=e||(t=a[t]),s.emit(e,t)},function(){s.emit("close")},function(e){s.emit("error",e)});r.getEventEmitter=function(){return s},r.closeInput=function(){c.closeInput()},e.exports=r},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=n.length,i=0;i<e;i++)t+=n.charAt(Math.floor(Math.random()*r));return t}n.d(t,"a",function(){return l});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(48),u=Logger.get("ScriptCache");u.setLevel(Logger.OFF);var l=(n(0),function(e){function t(e){r(this,t);var n={};for(var o in e)n[o]=e[o];return n.rootPath=DEF_FILE_CACHE_DIR+"/scripts",i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n))}return o(t,e),a(t,[{key:"_getHashedPath",value:function(e){u.debug("_getHashedPath - url: "+e);var t=this.rootPath+"/"+s(10)+".js";return u.debug("_getHashedPath - url: "+e+" - returning "+t),t}}]),t}(c))},function(e,t,n){"use strict";var r=n(0),i=n(24),o=n(25),s=n(3),a=n(1).Transform,c=n(23),u=n(26),l=n(21),f=n(8),h=n(20),p=s.getReadOnlyDir(),d="//system/apps/globoplay_activity/client/",g="//system/apps/globoplay_activity/engine/",y="//data/astronav//apps/",v="versiondata.json",m=p+"/"+v;try{var b=JSON.parse(r.readFileSync(m,"utf8")),_="http://"+u.parse(b.url).host,w=u.parse(b.url).path.substr(0,u.parse(b.url).path.indexOf("apps/globoplay/globoplay.zip")),k=w+"client/"+v,S=w+"engine/"+v,E=w+"apps/globoplay/"+v}catch(e){var b=void 0,_=void 0,w=void 0,k=void 0,S=void 0,E=void 0}console.log("[UpdateServices] LOCALJSON: "+b),console.log("[UpdateServices] HOST_NAME: "+_),console.log("[UpdateServices] DOWNLOAD_PATH: "+w),console.log("[UpdateServices] CLIENT_VERSION_DATA_LOCAL: //system/apps/globoplay_activity/client/versiondata.json"),console.log("[UpdateServices] ENGINE_VERSION_DATA_LOCAL: //system/apps/globoplay_activity/engine/versiondata.json"),console.log("[UpdateServices] APP_VERSION_DATA_LOCAL: "+m),console.log("[UpdateServices] CLIENT_VERSION_DATA_REMOTE: "+k),console.log("[UpdateServices] ENGINE_VERSION_DATA_REMOTE: "+S),console.log("[UpdateServices] APP_VERSION_DATA_REMOTE: "+E);var L=5e3,R={};R.getInstalledVersion=function(e){console.log("[UpdateServices] getInstalledVersion(mode = "+e+")");var t={};if("engine"==e)try{t=JSON.parse(r.readFileSync("//system/apps/globoplay_activity/engine/versiondata.json","utf8"))}catch(e){return void console.log(e)}else if("whole_client"==e)try{t=JSON.parse(r.readFileSync("//system/apps/globoplay_activity/client/versiondata.json","utf8"))}catch(e){return void console.log(e)}else if("app_only"==e)try{var n=m;r.existsSync(y+"/globoplay")&&(n="//data/astronav//apps//globoplay/versiondata.json"),t=JSON.parse(r.readFileSync(n,"utf8"))}catch(e){return void console.log(e)}return t},R.getPackageVersion=function(e,t){function n(t,s){var a=null;if(0==t.indexOf("http://")?a=i:0==t.indexOf("https://")&&(a=o),a){var c=a.request(t,function(i){if(i.statusCode>=300&&i.statusCode<400&&i.headers.location)n(i.headers.location,s);else if(i.statusCode>=400&&i.statusCode<500)s("Connection error: "+i.statusCode,null);else{i.setEncoding("utf8");var o="";i.on("data",function(e){o+=e}),i.on("end",function(){var n;try{n=JSON.parse(o)}catch(e){console.error("Error parsing JSON metadata downloaded from "+t),console.error(e)}n?(r.writeFileSync("/tmp/astronav/"+e+".json",o),s(null,n)):s("Metadata format error (or response from proxy)",null)})}});c.on("socket",function(e){e.setTimeout(L),e.on("timeout",function(){console.error("timeout occurred"),c.abort(),s("Connection timeout",null)})}),c.on("error",function(e){s("Connection error: "+e,null)}),c.end()}else s("Protocol error!",null)}console.log("[UpdateServices] getPackageVersion(mode = "+e+", callback = "+t+")");var s=void 0;if("engine"==e?s=S:"whole_client"==e?s=k:"app_only"==e&&(s=E),s){var a=(h.getPersistent().get("traits.selfupdate.host")||_)+s;console.log("[UpdateServices] UpdateServices.getPackageVersion: "+a),n(a,t)}else t("Path undefined!",null)},R.downloadPackage=function(e,t,n){function s(e,t,n){console.log("[UpdateServices] __downloadPackage(url = "+e+", path_to = "+t+", callback = "+n+")");var c=null;0==e.indexOf("http://")?c=i:0==e.indexOf("https://")&&(c=o);var u=0;if(c){var l=c.request(e,function(i){if(i.statusCode>=300&&i.statusCode<400&&i.headers.location)s(i.headers.location,t,n);else if(i.statusCode>=400&&i.statusCode<500)console.log("[UpdateServices] downloadPackage(url = "+e+", path_to = "+t+", callback = "+n+") - connection error"),n("Connection error: "+i.statusCode,null);else{var o=new a,c=i.headers["content-length"];i.on("data",function(e){o.push(e),u+=e.length,n("progress",{loaded:u,total:c})}),i.on("end",function(){console.log("[UpdateServices] downloadPackage(url = "+e+", path_to = "+t+", callback = "+n+") - finished downloading"),r.writeFileSync(t,o.read()),n("end",null)})}});l.on("socket",function(r){r.setTimeout(L),r.on("timeout",function(){console.log("[UpdateServices] downloadPackage(url = "+e+", path_to = "+t+", callback = "+n+") - timeout"),l.abort(),n("Connection timeout",null)})}),l.on("error",function(r){console.log("[UpdateServices] downloadPackage(url = "+e+", path_to = "+t+", callback = "+n+") - download error "+r),n("Download error: "+r,null)}),l.end()}else n("error",null)}console.log("[UpdateServices] downloadPackage(package_url = "+e+", path_to = "+t+", callback = "+n+")");var c=u.parse(e);console.log("----------------------------------------------------"),console.log(f.inspect(c)),console.log("----------------------------------------------------");var l=h.getPersistent().get("traits.selfupdate.host");if(l){var p=u.parse(l);console.log("----------------------------------------------------"),console.log(f.inspect(p)),console.log("----------------------------------------------------"),c.host=p.host,c.port=p.port,c.path=p.pathname+c.pathname,e=l+c.pathname}s(e,t,n)},R.checkPackageIntegrity=function(e,t,n){console.log("[UpdateServices] checkPackageIntegrity(path = "+e+", checksum = "+t+", callback = "+n+")"),r.readFile(e,function(r,i){if(r&&!i)console.log("[UpdateServices] checkPackageIntegrity(path = "+e+", checksum = "+t+", callback = "+n+") - notifying error "+r),n(!1);else{var o=c.createHash("md5").update(i).digest("hex");console.log("[UpdateServices] checkPackageIntegrity(path = "+e+", checksum = "+t+", callback = "+n+") - downloaded checksum: "+o),o==t?(console.log("[UpdateServices] checkPackageIntegrity(path = "+e+", checksum = "+t+", callback = "+n+") - md5sum is ok :)"),n(!0)):(console.log("[UpdateServices] checkPackageIntegrity(path = "+e+", checksum = "+t+", callback = "+n+") - md5sum is bad :("),n(!1))}})},R.extractPackage=function(e,t,r,i){console.log("[UpdateServices] extractPackage(mode = "+e+", path = "+t+", destination_dir = "+r+", callback = "+i+")");var o=function(){var o=n(34),s=new o(t);s.on("error",function(n){console.log("[UpdateServices] extractPackage(mode = "+e+", path = "+t+", destination_dir = "+r+", callback = "+i+") - unzipper caught error "+n),console.trace(),i("error",null)}),s.on("extract",function(n){console.log("[UpdateServices] extractPackage(mode = "+e+", path = "+t+", destination_dir = "+r+", callback = "+i+") - unzipper finished extracting"),i("end",null)}),s.on("progress",function(e,t){i("progress",{loaded:e+1,total:t})}),s.extract({path:r,filter:function(e){return"SymbolicLink"!==e.type}})};this.cleanupFilesystem(e,o)},R.cleanupFilesystem=function(e,t){console.log("[UpdateServices] cleanupFilesystem(mode = "+e+", onEndCallback = "+t+")");var n=void 0;"engine"==e?n=g:"whole_client"==e?n=d:"app_only"==e&&(n=y),n&&(console.log("[UpdateServices] cleaning filesystem: "+n),process.chdir("//data/astronav/"),l.deleteFolderRecursive(n),t&&t())},R.replaceVersion=function(e,t,n,r){console.log("[UpdateServices] replaceVersion(mode = "+e+", from_dir = "+t+", appname = "+n+", onEndCallback = "+r+")");var i=void 0;"engine"==e?i=g:"whole_client"==e?i=d:"app_only"==e&&(i=y),i&&(console.log("[UpdateServices] copying downloaded app from directory "+t+" to directory: "+i),l.replaceVersion(t,i,n),r&&r())},e.exports=R},function(e,t,n){var r=n(62),i=n(3),o={},s=function(e,t){return e},a=function(){return i.getClockMillis()},c=Logger.get("DNSLookup");c.setLevel(Logger.OFF);var u=function(e,t,n){if(c.debug("[DNSLookup] lookup - hostname: "+e),c.debug("[DNSLookup] lookup - options: "+t),!i.getProperty("traits.dns.use_cached_lookup"))return r.lookup(e,t,n);n&&"function"!=typeof t||(n=t);var u=s(e),l=o[u];if(l){if(c.debug("[DNSLookup] found lookup cache data: "+l),c.debug("[DNSLookup] lookup cache data - address: "+l.address),c.debug("[DNSLookup] lookup cache data - family: "+l.family),l.loading)return c.debug("[DNSLookup] lookup cache data - DNS for this host is already loading. Pushing callback to wait list"),l.callbacks=l.callbacks||[],void l.callbacks.push(n);if(a()<l.expires)return void setImmediate(function(e){n(null,l.address,l.family)});c.debug("[DNSLookup] lookup cache data - data expired")}l=o[u]={loading:!0,callbacks:[n]};var f=t.family||4,h=4==f?r.resolve4:r.resolve6;c.debug("[DNSLookup] no lookup cache data"),h(e,{ttl:!0},function(e,t){if(c.debug("[DNSLookup] dns.lookup.callback - err: "+e),c.debug("[DNSLookup] dns.lookup.callback - dnsinfo: "+t),l.loading=!1,e||0==t.length)for(var n=0;n<l.callbacks.length;n++)c.debug("[DNSLookup] dns.lookup.callback - DNS did not resolve - notifying callback "+n),l.callbacks[n](e,t,f);else{var r=t[0].address,i=t[0].ttl;l.address=r,l.family=f,l.expires=a()+1e3*i,c.debug("[DNSLookup] dns.lookup.callback - address: "+l.address),c.debug("[DNSLookup] dns.lookup.callback - family: "+l.family),c.debug("[DNSLookup] dns.lookup.callback - expires: "+l.expires);for(var o=0;o<l.callbacks.length;o++)c.debug("[DNSLookup] dns.lookup.callback - DNS resolved - notifying callback "+o),l.callbacks[o](e,r,f)}})};e.exports=u},function(e,t,n){var r=Logger.get("DOM-POLYFILL");r.setLevel(Logger.OFF);var i=n(20),o=function(){r.debug.apply(r,arguments)},s=function(){this._prefix="dom_localStorage",this._getKey=function(e){return this._prefix+e},this.setItem=function(e,t){i.getPersistent().set(this._getKey(e),t)},this.getItem=function(e){return i.getPersistent().get(this._getKey(e))},this.removeItem=function(e){i.getPersistent().set(this._getKey(e),null)},this.clear=function(){},Object.defineProperty(this,"active-user",{set:function(e){},get:function(){if(user.isUserLogged()){var e={id:user.getUserId(),glbId:user.getGloboID(),name:user.getUserName(),email:user.getUserEmail(),photoURL:user.getUserPicture(),isSubscriber:user.isSubscriber(),assinante:user.isSubscriber()};return JSON.stringify(e)}}})},a=function(){this.align="",this.allow="",this.allowfullscreen=!0,this.allowPaymentRequest=!0,this.contentDocument=new v,this.contentWindow=window,this.csp="",this.frameBorder="",this.height="0px",this.longDesc="",this.marginHeight="0px",this.marginWidth="0px",this.name="HTMLIFrameElement",this.policy="",this.referrerPolicy="",this.sandbox="",this.scrolling="",this.src="",this.srcdoc="",this.width="0px"},c=function(){this.hash="",this.host="",this.hostname="",this.href="",this.origin="",this.pathname="",this.port="",this.protocol="",this.search="",this.toString=function(){return"Location"},this.assign=function(){o(this+" assign")},this.reload=function(){o(this+" reload")},this.replace=function(){o(this+" replace")}},u=function(e,t){this.width=e||0,this.height=t||0,this.x=0,this.y=0,this.src=""},l=function(e){this.cssText=e,this.cssFloat="",this.length=0,this.parentRule=void 0,this.props={},this.getPropertyPriority=function(e){return 0},this.getPropertyValue=function(e){return this.props[e]||""},this.item=function(e){return Object.values(this.props)[e]},this.removeProperty=function(e){o(this+" removeProperty(prop = "+e+")"),this.props=void 0,this.length--},this.setProperty=function(e,t){o(this+" setProperty(prop = "+e+", value: "+t+")"),this.props=t,this.length++},this.toString=function(){return"CSSStyleDeclaration@"+this.cssText}},f=function e(t){this.bubbles=!1,this.cancelBubble=function(){},this.cancelable=!1,this.currentTarget={},this.deepPath=[],this.defaultPrevented=!1,this.eventPhase="start",this.explicitOriginalTarget={},this.originalTarget={},this.returnValue=!1,this.srcElement={},this.target={},this.timeStamp=PlatformServices.getClockMillis(),this.type=t,this.isTrusted=!0,this.scope=!1,this.createEvent=function(t){return new e(t)},this.composedPath=function(){return""},this.initEvent=function(){},this.preventDefault=function(){this.defaultPrevented=!0},this.stopImmediatePropagation=function(){},this.stopPropagation=function(){}},h=function(){this.cssFloat="",this.bottom="",this.removeProperty=function(e){o(this+" removeProperty - prop: "+e)},this.addProperty=function(e){o(this+" addProperty - prop: "+e)}},p={},d={},g=function(){this.item=function(e){o(this+" item - index: "+e)},this.contains=function(e){return o(this+" contains - token: "+e),!1},this.add=function(e){o(this+" add - token: "+e)},this.remove=function(e){return o(this+" remove - token: "+e),e},this.replace=function(e,t){o(this+" replace - oldToken: "+e+" - newToken: "+t)},this.supports=function(e){return o(this+" supports - token: "+e),!1},this.toggle=function(e){return o(this+" toggle - token: "+e),!1},this.entries=function(){o(this+" entries")},this.forEach=function(e,t){o(this+" forEach - callback: "+e+" - contents: "+t)},this.keys=function(){o(this+" keys")},this.values=function(){o(this+" values")}},y=function(){this.bottom=0,this.height=0,this.left=0,this.right=0,this.top=0,this.width=0,this.x=0,this.y=0},v=function e(t){this._tag=t,this.style=new h,this.nodeType=1,this.childNodes=[],this.nodeName=t,this.ownerDocument=global.document,this._numChildren=0,this._tag&&(p[this._tag]=p[this._tag]||[],p[this._tag].push(this)),this.classList=new g,this.css=function(e){return o(this+" css - prop: "+e),this.style[e]},this.setAttribute=function(e,t){o(this+" setAttribute - attr: "+e+", value: "+t),this[e]=t,this[e].name=t,this[e].value=t,"id"==e&&(d[t]=this)},this.getAttribute=function(e){return o(this+" getAttribute - attr: "+e+", value: "+this[e]),this[e]},this.getAttributeNode=function(e){return o(this+" getAttributeNode - attr: "+e+", value: "+this[e]),this[e]},this.hasAttribute=function(e){return o(this+" hasAttribute - attr: "+e),!!this[e]},this.removeAttribute=function(e){o(this+" removeAttribute - attr: "+e)},this.appendChild=function(e){o(this+" appendChild: "+e),e.parentNode=this,this[this._numChildren+1]=e,this._numChildren++,this.childNodes.push(e)},this.removeChild=function(e){o(this+" removeChild: "+e);var t=this.childNodes.indexOf(e);this.childNodes.splice(t,1),this._numChildren--},this.replaceChild=function(e,t){o(this+" replaceChild: newChild: "+e+" oldChild: "+t);var n=this.childNodes.indexOf(t);this.childNodes[n]=e},this.insertBefore=function(e){o(this+" insertBefore "+e),this[this._numChildren+1]=e,this._numChildren++,this.childNodes.push(e)},this.toString=function(){return"DomNode@"+this._tag},this.contains=function(){return o.apply(void 0,[this+" contains: "].concat(Array.prototype.slice.call(arguments))),!1},this.canPlayType=function(e){return o(this+" canPlayType - type = "+e),""},this.play=function(){o(this+" play")},this.addEventListener=function(e,t){o(this+" addEventListener - event = "+e+", callback =",t)},this.removeEventListener=function(e,t){o(this+" removeListener - event = "+e+", callback =",t)},this.dispatchEvent=function(e){o(this+" dispatchEvent - event "+e)},this.attachEvent=function(e,t){o(this+" attachEvent - event = "+e+", callback =",t)},this.detachEvent=function(e,t){o(this+" detachEvent - event = "+e+", callback =",t)},this.querySelector=function(t){return o(this+" querySelector",t),"head"==t?this.head:new e("div")},this.querySelectorAll=function(t){return o(this+" querySelectorAll",t),[new e("div")]},this.getBoundingClientRect=function(){return o(this+" getBoundingClientRect"),new y},this.styleSheet=new l},m=function(){this._tag="script",this._children=[],this.nodeType=1,this.type="text/javascript",this._tag&&(p[this._tag]=p[this._tag]||[],p[this._tag].push(this)),this.getAttribute=function(e){return o(this+" getAttribute - attr: "+e),this[e]},this.setAttribute=function(e,t){o(this+" setAttribute - attr: "+e+", value: "+t),this[e]=t,"id"==e&&(d[t]=this)},this.appendChild=function(e){o(this+" appendChild: "+e),this._children.push(e)},this.insertBefore=function(e){o(this+" insertBefore "+e)},this.toString=function(){return"ScriptNode"},this.contains=function(){return o.apply(void 0,[this+" contains: "].concat(Array.prototype.slice.call(arguments))),!1},this.canPlayType=function(e){return o(this+" canPlayType - type = "+e),""},this.styleSheet=new l,this.readyState="interactive",Object.defineProperty(this,"src",{set:function(e){var t=this;"http"!=e.substr(0,4)&&(e="http:"+e),o(this+" LOADING SCRIPT WITH URL: "+e),this._src=e,this.readyState="loading",ScriptLoader.load(e).then(function(e){if(t.readyState="loaded",t.onload){var n=new f("load");o(t+" invoking on load callback"),t.onload(n),o(t+" load callback finished!")}}).catch(function(e){if(t.onerror){o(t+" invoking on error callback",e);var n=new f("error");t.onerror(n)}})},get:function(){return this._src}})},b=function(){PlatformServices.getProperty("system.os"),PlatformServices.getProperty("system.manufacturer"),PlatformServices.getProperty("system.model");this.activeVRDisplays=[],this.appCodeName="Globoplay-SDK",this.appName="Globoplay-SDK",this.appVersion="0.8.6",this.battery={},this.connection={},this.cookieEnabled=!1,this.geolocation={},this.hardwareConcurrency=1,this.javaEnabled=!1,this.keyboard={},this.language="Portuguese",this.languages=[this.language],this.locks={},this.mediaCapabilities={},this.maxTouchPoints=0,this.mimeTypes=[],this.onLine=!0,this.oscpu="Linux",this.permissions={},this.platform=DEF_PLATFORM,this.plugins=[],this.product="Gecko",this.serviceWorker={},this.storage={},this.userAgent=PlatformServices.getProperty("userAgent"),this.webdriver=!1},_=function(e){return o("getComputedStyle - element = "+e),new l(""+e)};global.removeEventListener=function(e,t){o("removeEventListener - event = "+e)};var w=function(){this.head=new v("head"),this.head[0]=new v("stub_head"),this.body=new v("body"),this.documentElement=new v("html"),this.URL="https://",this._cookie="",this.nodeType=9,this.location=new c,this.defaultView=window,this.toString=function(){return"Document"},this.createElement=function(e){return o(this+" createElement(tag = "+e+")"),"script"==e?new m:new v(e)},this.getElementById=function(e){return o(this+" getElementById(id = "+e+")"),d[e]||new v("div")},this.createDocumentFragment=function(){return o(this+" createDocumentFragment"),new v("div")},this.contains=function(){return o.apply(void 0,[this+" contains:"].concat(Array.prototype.slice.call(arguments))),!0},this.write=function(e){o(this+" write - ",e)},this.querySelector=function(e){return o(this+" querySelector",e),"head"==e?this.head:new v("div")},this.querySelectorAll=function(e){return o(this+" querySelectorAll",e),[new v("div")]},this.createTextNode=function(e){return o(this+" createTextNode -  text = "+e),new v("text")},this.createComment=function(e){return o(this+" createComment -  text = "+e),new v("div")},this.getElementsByTagName=function(e){return o(this+" getElementsByTagName - tagName = "+e+" returning:",p[e]),p[e]||[]},this.getElementsByClassName=function(e){return o(this+" getElementsByClassName - className = "+e+" returning:",p[e]),p[e]||[]},this.addEventListener=function(e,t){if(o(this+" addEventListener - event = "+e+", callback =",t),e&&t&&("keydown"==e||"keyup"==e)){var n="keyup"==e?"keyrelease":"keypress";o(this+" addEventListener - registering event "+n+" on InputServices"),InputServices.getEventEmitter().on(n,t)}},this.removeEventListener=function(e,t){if(o(this+" removeEventListener - event = "+e+", callback =",t),e&&t&&("keydown"==e||"keyup"==e)){var n="keyup"==e?"keyrelease":"keypress";InputServices.getEventEmitter().removeListener(n,t)}},this.attachEvent=function(e,t){o(this+" attachEvent - event = "+e+", callback =",t)},this.detachEvent=function(e,t){o(this+" detachEvent - event = "+e+", callback =",t)},this.createEvent=function(e){return o(this+" createEvent - type = "+e),new f(e)},Object.defineProperty(this,"cookie",{set:function(e){o("Cookie - SET: "+e),this._cookie&&""!=this._cookie?this._cookie+=";"+e:this._cookie=e+""},get:function(){return o("Cookie - GET: "+this._cookie),this._cookie}})},k=function(){this.navigation={},this.timing={},this.timeOrigin=PlatformServices.getClockMillis(),this.clearMarks=function(){},this.clearMeasures=function(){},this.clearResourceTimings=function(){},this.getEntries=function(){},this.getEntriesByName=function(){},this.getEntriesByType=function(){},this.mark=function(){},this.measure=function(){},this.now=function(){return PlatformServices.getClockMillis()},this.setResourceTimingBufferSize=function(){},this.toJSON=function(){}},S=function(){this.pushState=function(e,t,n){o(this+" pushState "+n)}},E=function(){global.__domPolyfillDefined__||(global.__domPolyfillDefined__=!0,global.window=global,global.addEventListener=function(){},global.document=new w,global.location=document.location,global.getComputedStyle=_,global.open=function(){return window},global.navigator=new b,global.HTMLIFrameElement=a,global.performance=new k,global.history=new S,global.Image=u,global.localStorage=new s)};e.exports=E},function(e,t,n){"use strict";function r(e,t,n){i(e,t,n);for(var r=p(n)?"wx":"w",o=s.statSync(e),c=o.size,u=o.mode,l=s.openSync(e,"r"),f=s.openSync(t,r,u),h=c<a?c:a,d=0,g=c<a?0:c%a,y=Buffer.allocUnsafe(h),v=0;h+d+g<=c;v++,d=h*v)s.readSync(l,y,0,h,d),s.writeSync(f,y,0,h,d);if(g){var m=g;y=Buffer.allocUnsafe(m),s.readSync(l,y,0,m,d),s.writeSync(f,y,0,m,d)}s.closeSync(l),s.closeSync(f)}function i(e,t,n){if("string"!=typeof e)throw d("src",e);if("string"!=typeof t)throw d("dest",t);if(n&&u(n)&&(n>h||n<0))throw Error("EINVAL: invalid argument, copyfile -> '"+t+"'")}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=n(0),a=65536,c={COPYFILE_EXCL:1,COPYFILE_FICLONE:2,COPYFILE_FICLONE_FORCE:4};e.exports=s.copyFileSync?s.copyFileSync:r,e.exports.constants=c;var u=function(e){return"number"==typeof e},l=function(e,t){return e|t},f=function(e){return function(t){return e[t]}},h=function(e){return Object.keys(e).map(f(e)).reduce(l)}(c),p=function(e){return 1&e},d=function(e,t){var n=TypeError('The "'+e+'" argument must be one of type string, Buffer, or URL. Received type '+(void 0===t?"undefined":o(t)));return n.code="ERR_INVALID_ARGS_TYPE",n}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"ScriptLoader",function(){return c});var i=n(50),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=Logger.get("ScriptLoader");s.setLevel(Logger.OFF);var a=new i.a({sizeLimit:DEF_FILE_CACHE_SIZE}),c=function(){function e(){r(this,e)}return o(e,null,[{key:"load",value:function(e){return new Promise(function(t,r){s.debug("ScriptLoader.load(path = "+e+")"),n(53)(),a.delete(e),a.get(e,function(e,n){if(s.debug("ScriptLoader.load - callback received err",e,"and object",n),e)return void r(e);var i=void 0,o=void 0;try{s.debug("ScriptLoader.load - running script at "+n.filename),o=require(n.filename),s.debug("ScriptLoader.load - script ran with return value:",o)}catch(e){s.debug("ScriptLoader.load - caught error while running the script",e),i=e}i?(s.debug("ScriptLoader.load - got load error, rejecting the promise"),r(i)):(s.debug("ScriptLoader.load - script loaded, resolving the promise"),t(o))})})}}]),e}()},function(e,t,n){var r=(n(9).get("globoplay-web-emu:mirakulo:LRUCache"),n(58));!function(){"use strict";function t(e){this._purgeThreshold=e.purgeThreshold||.8,this._purgeTarget=e.purgeTarget||.6,this._sizeLimit=e.sizeLimit,this._sizePurgeThreshold=this._purgeThreshold*this._sizeLimit,this._sizePurgeTarget=this._purgeTarget*this._sizeLimit,this._sumObjSizes=0,this._cacheLinkedList=new r.DoublyLinkedList}var n=t.prototype;n.get=function(e,t,n){var r=this._cacheLinkedList.find(e);if(r){if(this._cacheLinkedList.removeByKey(e),this._cacheLinkedList.prepend(r,e),!t)return r;t(null,r)}else if(t)return void this.fetch(e,function(n,r,i){!n&&r&&i?(this._cacheLinkedList.prepend(r,e),this._sumObjSizes+=i,t(null,r),this._checkAndSchedulePurge()):t("[LRU Cache ERROR]: "+n,null)}.bind(this),n)},n.getUsedSize=function(){return this._sumObjSizes},n._checkAndSchedulePurge=function(){this._sizePurgeThreshold<=this.getUsedSize()&&this.purge()},n.dump=function(){this._cacheLinkedList.dump()},n.delete=function(e){var t=this._cacheLinkedList.find(e);t&&!t.unpurgeable&&(this._sumObjSizes-=t.objsize,this.doDelete(e),this._cacheLinkedList.removeByKey(e))},n.purge=function(){var e=this._cacheLinkedList.tail();if(!e)return void console.warn("LRUCache.purge - linked list tail is null");for(;this._sizePurgeTarget<this.getUsedSize();){var t=e.prev,n=e.data,r=e.key;if(n.unpurgeable||(this._sumObjSizes-=n.objsize,this.doDelete(r),this._cacheLinkedList.removeByKey(r)),!t){console.warn("LRUCache.purge - reached the end of the list");break}e=t}this._scheduledPurge=null},n.check=function(e){return this._cacheLinkedList.find(e)},n.clear=function(){console.log("[LRUCache.clear] BEGIN - size = "+this._cacheLinkedList.size());var e=this._cacheLinkedList._refTable,t=0;for(var n in e)e.hasOwnProperty(n)&&(this.doDelete(n),t++);console.log("[LRUCache.clear] END - removed "+t+" elements"),this._cacheLinkedList=new r.DoublyLinkedList},e.exports=t}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"SocketClient",function(){return o});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=(n(9).get("globoplay-web-emu:mirakulo:SocketClient"),function(){function e(t){r(this,e),this.wrapper=t,this.handlers=[]}return i(e,[{key:"notify",value:function(e,t){this.handlers[e]&&this.handlers[e](t)}},{key:"on",value:function(e,t){this.handlers[e]=t}},{key:"send",value:function(e){this.wrapper&&this.wrapper.send(e)}},{key:"close",value:function(){this.isOpen()&&this.wrapper.close()}},{key:"destroy",value:function(){this.close(),delete this.wrapper}},{key:"isOpen",value:function(){return this.wrapper&&this.wrapper.isOpen}}]),e}())},function(e,t,n){n(9).get("globoplay-web-emu:mirakulo:doubly-linked-list");!function(e){"use strict";function t(){this._head=null,this._tail=null,this._length=0,this._refTable={}}t.prototype._createNewNode=function(e,t){var n=this;return{data:e,key:t,next:null,prev:null,remove:function(){null!==this.prev&&(this.prev.next=this.next),null!==this.next&&(this.next.prev=this.prev),n._head===this&&(n._head=this.next),n._tail===this&&(n._tail=this.prev),n._length--},prepend:function(e,t){if(n._head===this)return n.prepend(e,t);var r=n._createNewNode(e);return r.prev=this.prev,r.next=this,this.prev.next=r,this.prev=r,n._length++,r},append:function(e,t){if(n._tail===this)return n.append(e,t);var r=n._createNewNode(e,t);return r.prev=this,r.next=this.next,this.next.prev=r,this.next=r,n._length++,r}}},t.prototype.append=function(e,t){var n=this._createNewNode(e,t);return 0===this._length?(this._head=n,this._tail=n):(this._tail.next=n,n.prev=this._tail,this._tail=n),this._length++,this._refTable[t]=n,n},t.prototype.prepend=function(e,t){if(null===this._head)return this.append(e,t);var n=this._createNewNode(e,t);return this._head.prev=n,n.next=this._head,this._head=n,this._length++,this._refTable[t]=n,n},t.prototype.item=function(e){if(e>=0&&e<this._length){for(var t=this._head;e--;)t=t.next;return t}},t.prototype.find=function(e){if(this._refTable[e])return this._refTable[e].data},t.prototype.head=function(){return this._head},t.prototype.tail=function(){return this._tail},t.prototype.last=function(){if(this._tail)return this._tail.data},t.prototype.size=function(){return this._length},t.prototype.remove=function(e){var t=this._length-e-1;if(t>=0&&t<this._length){for(var n=this._tail;t--;)n=n.prev;delete this._refTable[n.key],n.remove()}},t.prototype.removeByKey=function(e){this._refTable[e]&&(this._refTable[e].remove(),delete this._refTable[e])},t.prototype.dump=function(){console.log("----------------------------------------------------");for(var e=0,t=this._head;t;t=t.next)console.log("\t("+e+")"+t.key),e++;console.log("----------------------------------------------------")},e.DoublyLinkedList=t}(t)},function(e,t){e.exports={"tween.animation.level":2,"traits.player.change_video_onthefly":!1,"traits.imagecache.limit":36700160,"traits.bitmap.preload_offscreen":!1,"traits.bitmap.dispose_offscreen":!0,"system.has_revenue_share":!0,"system.subscribe_url":"www.globoplay.com/tcl","system.subscribe_qrcode":"./resource/image/qrcode/qrcode-tcl.png","traits.title_screen.force_old_title":!1,"traits.home_screen.max_rail_length":24,"traits.background.dispose_swapped_bitmaps":!0,"traits.player.video_HD_format":"tv_hls","traits.player.video_live_format":"tv_hls","traits.player.video_drm_format":"tv_ss","traits.player.change_audio_supported":!0,"traits.player.prefer_video_localized":!0,"system.low_end":!0}},function(e,t){e.exports=require("assert")},function(e,t){e.exports=require("child_process")},function(e,t){e.exports=require("dns")},function(e,t){e.exports=require("net")},function(e,t){e.exports=require("zlib")}]);